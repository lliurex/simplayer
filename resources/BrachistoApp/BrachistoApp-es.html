<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="stylesheet.css">
<link rel="stylesheet" type="text/css" href="../common/stylesheet1.css">
<script src="../../jquery/jquery.min.js"></script>
<title>Curva Braquistócrona</title>

<script type="text/javascript" async
  src="../../mathjax/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script>
  document.getElementsByTagName("html")[0].style.visibility = "hidden";
</script>
</head>
<body>

<h1>Curva Braquistócrona</h1>

<ul id="header_bar" class="horiz_tabs">
  <li class="sim selected">Simulador</li>
  <li class="graph ">Gráfico</li>
  <li class="time_graph">Gráfico de tiempo</li>
  <li class="multi_graph">Gráfico múltiple</li>
</ul>

<div id="container" class="control_container">
  <div id="div_graph" >
  </div>
  <div id="div_time_graph" >
  </div>
  <div id="sim_applet" >
  </div>
  <div id="sim_controls" class="control_group">
  </div>
  <div id="graph_controls" class="control_group">
  </div>
  <div id="time_graph_controls" class="control_group">
  </div>
  <p>
  <label id="label_show_sim">
    <input type="checkbox" id="show_sim">show sim
  </label>
   <label id="label_terminal">
    <input type="checkbox" id="show_terminal">terminal
   </label>
   <div id="div_terminal">
     <textarea id="term_output" cols=80 rows=20 wrap="soft"></textarea> <br>
     <label style="display:inline-block">command &gt;
       <input type="text" id="term_input" size="80">
     </label>
   </div>
</div>

<h2>Acerca de</h2>

<p class="introduction">
  Dados dos puntos, ¿a lo largo de qué camino puedes deslizarte más rápido? A ver si puedes elegir el
  camino más rápido en esta simulación del famoso problema Braquistocrona.
</p>

<p class="instructions">
  Haz clic cerca de uno de los caminos para elegir el más rápido y comenzar la simulación. Puede
  También cambia parámetros como la gravedad, la amortiguación, etc.
</p>


<button type="button" class="technical-toggle"></button>

<div class="technical" style="display:none;">

  <p>The math behind the simulation is shown below.  Also available are:
    <a href="https://github.com/myphysicslab/myphysicslab/blob/master/src/sims/roller/BrachistoApp.js">open source code</a>,
    documentation and a
    simple-compiled version
    which is more customizable.
    </p>

    <h2>The Brachistochrone Problem</h2>

    <p class="instructions">
    Given two points A and B in a vertical plane, what is the curve traced out by a point acted on only by gravity, which starts at A and reaches B in the shortest time?
    </p>

    <p>
    This was the challenge problem that Johann Bernoulli set to the thinkers of his time in 1696.  Calculus had only just been invented, yet the solution to this problem uses a fairly advanced technique called the Calculus of Variations.</p>

    <p>You are perhaps familiar with the use of calculus to figure out things like area under a given curve.  Using Calculus of Variations we can find <i>the curve</i> which maximizes the area enclosed by a curve of a given length (a circle).  Or, in the case of the Brachistochrone problem, we find the curve which minimizes the time it takes to slide down between two given points.  The unknown here is an <i>entire function</i> - the curve - not just a single number like area or time.  We wind up thinking about infinitesmal variations of a function, similarly to how in calculus we think about the infinitesmal variation of a single variable.  </p>


    <p>The name <i>brachistochrone</i> comes from two Greek words, <i>brachistos</i> meaning shortest, and <i>chronos</i> meaning time.  The brachistochrone curve can be generated by tracking a point on the rim of a wheel as it rolls on the ground.  The general equation for the brachistochrone is given parametrically as</p>

    <p>$$x = a(\theta - \sin \theta) + x_0$$</p>

    <p>$$y = -a(1 - \cos \theta) + y_0$$</p>


    <p>where <i>a</i> is the radius of the wheel, and the wheel rolls along the horizontal line \( y = y_0 \).</p>


    <p>This simulation uses software techniques identical to those described for the
    <a href="../RollerSingleApp/RollerSingleApp-es.html#physics">Simple Roller Coaster</a>, please see that page
    for more information on the physics and on how the simulation is done.</p>

    <p>The points chosen for the simulation are \( A=(0, 0) \) and \( B=(3, -2) \).  The equations for the paths in the simulation are</p>

    <ul>

    <li>Brachistochrone \(  \{x = 1.00133(\theta - \sin \theta), \; y = -1.00133(1 - \cos \theta)\} \)</li>

    <li>Linear \(  y = - (2/3) x \)</li>

    <li>Parabola-up \(  y = -2 + (2/9)(x-3)^2 \)</li>

    <li>Parabola-down \(  y = 0.0416667 - 0.166667(x+0.5)^2 \)</li>

    <li>Circle \(  \{x = 3 + (13/4)\cos \theta, \; y = -2 + (13/4)(1 + \sin \theta)\} \)</li>

    <li>Brachistochrone-squared \(  \{x = 1.00133(\theta - \sin \theta), \; y = 2(1.00133)(-1 + (1-\frac{1-\cos \theta}{2})^2)\} \)</li>

    </ul>

    <p>Here are some videos about the Brachistochrone.</p>

    <ul>

    <li><a href="https://www.youtube.com/watch?v=VRgxJCWBKk0">Brachistochrone Problem - Think you know which ramp is fastest?</a></li>

    <li><a href="https://www.youtube.com/watch?v=Cld0p3a43fU">The Brachistochrone, with Steven Strogatz</a></li>

    </ul>


    <h2>Setting up the Math for the Brachistochrone Problem</h2>

    <p>This section shows how to find the solution to the Brachistochrone problem using Calculus of Variations. (In his original solution, Bernoulli used a different method from the study of optics).  We generally follow the exposition given in <a href="http://www.amazon.com/Calculus-Variations-Robert-Weinstock/dp/0486630692/">Calculus Of Variations by Robert Weinstock</a>.</p>


    <p>Let the minimal-time-of-descent path be given by the function \( y(x) \) and let the starting and ending points have the coordinates \( (x_1, y_1) \) and \( (x_2, y_2) \).  Therefore we have that \( y(x_1) = y_1 \) and \( y(x_2) = y_2 \).  Let \( ds \) be the infinitesimal arc length along the path, so we can write the velocity as \( v = ds/dt \).  In calculus, we study how to find the length of a curve, and so we know (REFERENCE?) that \( ds = \sqrt{1 + y'^2} dx \) where \( y' = \frac{dy}{dx} \).  Rearrange the velocity equation to \( dt = ds/v \), and integrate it to get the time it takes to slide between the points: </p>

    <p>$$ \int_{x_1}^{x_2} dt = \int_{x_1}^{x_2} \frac{\sqrt{1 + y'^2}}{v} dx \tag{1}$$</p>

    <p>We can get an expression for the velocity by looking at the energy.  Let the initial velocity at the first point be \( v_1 \). Without friction, the energy should be constant and is given by the sum of kinetic and potential energy.  </p>

    <p>$$E = \frac{1}{2} m v_1^2 + m g y_1 = \frac{1}{2} m v^2 + m g y$$</p>

    <p>$$ v = \sqrt{v_1^2 + 2 g (y_1 - y)} \tag{2}$$</p>

    <p>To simplify our analysis, let's assume that the ball starts at rest so that \( v_1 = 0 \).  (Otherwise, we could define a constant for \( y_1 + v_1^2/2g \) which would let us get the equation into the same form as shown below). Equation (1) then becomes</p>

    <p>$$ \int_{x_1}^{x_2} dt = \frac{1}{\sqrt{2 g}} \int_{x_1}^{x_2} \frac{\sqrt{1 + y'^2}}{\sqrt{y_1 - y}} dx \tag{3}$$</p>

    <p>Our job is to find the function \( y(x) \) which minimizes this integral and passes through the two points.</p>

    <h2>The Euler-Lagrange Equation</h2>

    <p>The Euler-Lagrange equation is a differential equation that \( y(x) \) must satisfy in order to minimize (or possibly maximize) an integral of the form</p>

    <p>$$ I = \int_{x_1}^{x_2} f(x, y, y') dx  \tag{4}$$</p>

    <p>where also \( y(x) \) must pass through the two fixed end points \( y(x_1) = y_1 \) and \( y(x_2) = y_2 \).  Through reasoning about families of curves that include the minimizing curve \( y(x) \), (REFERENCE?) we can get the Euler-Lagrange equation:</p>

    <p>$$ \frac{\partial f}{\partial y} - \frac{d}{dx} \left( \frac{\partial f}{\partial y'} \right) = 0 \tag{5}$$</p>


    <p>We next use the following identity (easily verified by using rules for partial and total differentiation REFERENCE?),</p>

    <p>$$ \frac{d}{dx} \left( y' \frac{\partial f}{\partial y'} - f \right) =
      -y' \left[ \frac{\partial f}{\partial y} - \frac{d}{dx} \left( \frac{\partial f}{\partial y'} \right) \right]
      -\frac{\partial f}{\partial x}  \tag{6}$$</p>

    <p>Since we know that \( y(x) \) satisfies the Euler-Lagrange equation (5), we see that the first term on the right hand side must be zero.  If it happens that \( f(y, y', x) \) is independent of \( x \) then the second term will also be zero so that</p>

    <p>$$ \frac{d}{dx} \left( y' \frac{\partial f}{\partial y'} - f \right) = 0  \tag{7}$$</p>

    <p>which we can immediately integrate to find</p>

    <p>$$ y' \frac{\partial f}{\partial y'} - f  = C_1  \tag{8}$$</p>

    <p>where \( C_1 \) is a constant.  This special case, where \( f \) is independent of \( x \), gives us the first-order differential equation (8) involving only \( y, y' \) which is easier to solve than the Euler-Lagrange equation (5).</p>

    <h2>Solving for the Brachistochrone</h2>

    <p>Since the integrand in equation (3) is independent of \( x \), we can use the results of the previous section to find \( y(x) \) that minimizes the integral (3). Let \( f(y, y', x) \) be given by</p>

    <p>$$ f(y, y', x) = \frac{\sqrt{1 + y'^2}}{\sqrt{y_1 - y}}  \tag{9}$$</p>


    <p>Equation (8) then becomes</p>


    <p>$$ \frac{y'^2}{ \sqrt{(y_1 - y)(1 + y'^2)}} - \frac{\sqrt{1 + y'^2}}{\sqrt{y_1 - y}}  = C_1  \tag{10}$$</p>


    <p>Next we solve the above equation for \( y' \).</p>


    <p>$$ \frac{-1}{ \sqrt{(y_1 - y)(1 + y'^2)}} = C_1  \tag{11}$$</p>


    <p>$$ \frac{1}{ (y_1 - y)C_1^2} = 1 + y'^2  \tag{12}$$</p>


    <p>$$ y' = \sqrt{\frac{1}{ (y_1 - y)C_1^2} - 1} = \sqrt{\frac{1/C_1^2 - (y_1 -y)}{ y_1 - y}}  \tag{13}$$</p>

    <p>Take the reciprocal of both sides</p>

    <p>$$ \frac{dx}{dy} = \sqrt{\frac{y_1 - y}{1/C_1^2 - (y_1 - y)}}  \tag{14}$$</p>

    <p>Define the constant \( a = \frac{1}{2 C_1^2} \) and integrate (14) to get</p>

    <p>$$ x =  \int \frac{\sqrt{y_1 - y} \; dy}{\sqrt{2a - (y_1 - y)}}  \tag{15}$$</p>

    <p>Solving this integral will give us the minimal-time-of-descent path \( y(x) \) we are seeking.  Use a change of variables</p>

    <p>$$ y_1 - y = 2a \sin^2 \frac{\theta}{2}  \tag{16}$$</p>

    <p>which also implies</p>

    <p>$$ dy = -2a \sin \frac{\theta}{2} \cos \frac{\theta}{2} d\theta  \tag{17}$$</p>

    <p>Now equation (15) becomes</p>

    <p>$$ x =  \int \frac{\sqrt{2a \sin^2 \frac{\theta}{2}} \; (-2a \sin \frac{\theta}{2} \cos \frac{\theta}{2}) d\theta}{\sqrt{2a - 2a \sin^2 \frac{\theta}{2}}} =
       \int \frac{-2a \sin^2 \frac{\theta}{2} \cos \frac{\theta}{2} d\theta}{\sqrt{1 - \sin^2 \frac{\theta}{2}}} \tag{18}$$</p>

    <p>which simplifies to</p>

    <p>$$ x =  \int -2a \sin^2 \frac{\theta}{2}  d\theta \tag{19}$$</p>

    <p>Using the trig identity \( 2 \sin^2 \frac{\theta}{2} = 1 - \cos \theta \), we can solve this integral getting</p>

    <p>$$ x =  -a(\theta - \sin \theta) + C_2 \tag{20}$$</p>

    <p>where \( C_2 \) is a constant of integration.  Now we have the equation of the path in terms of the parameter \( \theta \) from equations (16) and (20).  We can rewrite equation (16) as</p>

    <p>$$ y = -a (1 - \cos \theta) + y_1 \tag{21}$$</p>

    <p>When \( \theta = 0 \) we find that \( x = C_2 \) and \( y = y_1 \), so this corresponds to the first point and we conclude that \( C_2 = x_1 \).  To find \( a \) we need to solve the simultaneous equations (22) and (23) for \( a, \theta \).</p>

    <p>$$ x_2 =  -a(\theta - \sin \theta) + x_1 \tag{22}$$</p>


    <p>$$ y_2 = -a (1 - \cos \theta) + y_1 \tag{23}$$</p>

    <p>For the points used in the simulation, which were (0,0) and (3, -2), we can use an equation solver (such as Mathematica's FindRoot function) to find \( a = 1.00133, \theta=-3.06878 \).  As a final cosmetic transformation, so that the value of \( \theta \) is increasing instead of decreasing as we go from the first point to the second, we can substitute \( -\theta \) for \( \theta \) and get</p>

    <p>$$ x =  a(\theta - \sin \theta) + x_1 \tag{24}$$</p>


    <p>$$ y = -a (1 - \cos \theta) + y_1 \tag{25}$$</p>

    <p>with \( a = 1.00133 \) and \( \theta \) increasing from 0 to 3.06878.</p>

</div>
<script>
  $(document).ready(function(){
    let lang=$('html').attr('lang')
    switch(lang){
      case 'ca':
      case 'en':
      case 'es':
        break;
      default:
        lang = es;
    }
    let msgs={
      'ca':{'off':'Ocultar informació tècnica (en anglés)','on':'Mostrar informació tècnica (en anglés)'},
      'es':{'off':'Ocultar información técnica (en inglés)','on':'Mostrar información técnica (en inglés)'},
      'en':{'off':'Hide technical information','on':'Show technical information'}
    }
    $('.technical-toggle').html(msgs[lang]['on'])
    $('.technical-toggle').click(function(){
      let display=$('.technical').css('display')
      if (display == 'none'){
        $('.technical').show()
        $('.technical-toggle').html(msgs[lang]['off'])
      }else{
        $('.technical').removeAttr('style').hide()
        $('.technical-toggle').html(msgs[lang]['on'])
      }
    })
  })
</script>

<div id="footer2" >
  <div id="copyright">
    &copy; <a href="mailto:erikn@myPhysicsLab.com"
    title="send comments to Erik Neumann">
    Erik Neumann</a>,  2004-2016<br>
    <span id="revised_date">revisado Feb 6 2021</span>
  </div>
</div>

<!-- Call the app script after the body so that html entities are defined and
* the script can find them.-->
<script src="BrachistoApp-es.js"></script>

<script>
  (function build() {
    var elem_ids = {
      tab_list: 'header_bar',
      container: 'container',
      term_output: 'term_output',
      term_input: 'term_input',
      sim_applet: 'sim_applet',
      div_graph: 'div_graph',
      graph_controls: 'graph_controls',
      sim_controls: 'sim_controls',
      div_terminal: 'div_terminal',
      div_time_graph: 'div_time_graph',
      time_graph_controls: 'time_graph_controls',
      div_multi_graph: 'div_multi_graph',
      multi_graph_controls: 'multi_graph_controls',
      label_terminal: 'label_terminal',
      show_terminal: 'show_terminal',
      show_sim: 'show_sim',
      images_dir: '../common'
    };
    app = makeBrachistoApp(elem_ids);
    app.defineNames('app');
    window.addEventListener('pageshow', function(event){
      // set language menu and compiled menus in case of back-button
      var menu = document.getElementById('language_menu');
      if (menu) { menu.selectedIndex = 2; }
      menu = document.getElementById('compiled_menu');
      if (menu) { menu.selectedIndex = 1; }
    }, /*capturing=*/false);
    window.addEventListener('blur', function(event){
      app.eval('FIRING=false;', /*output=*/false);
    }, /*capturing=*/false);
    window.addEventListener('focus', function(event){
      app.eval('FIRING=true;', /*output=*/false);
    }, /*capturing=*/false);
  }());
</script>

<script>
  document.getElementsByTagName("html")[0].style.visibility = "visible";
</script>

<script>var app; if (app) app.setup();</script>
<script>var app; if (app) app.start();</script>
<div id="footer2" >
  <div id="copyright">
    &copy; <a href="mailto:erikn@MyPhysicsLab.com"
    title="copyright 2020 Erik Neumann">
    Erik Neumann</a> 2020, available under
    <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2</a>
</div>
</body>
</html>
