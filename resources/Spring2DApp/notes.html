<p class="introduction">
This simulation shows a single mass on a spring, which is connected to the ceiling. The
mass is able to move in 2 dimensions, and gravity operates. Does the motion look random
to you? Watch the graph for a while and you'll see its actually an intricate pattern.
</p>

<p class="instructions">
You can change gravity, mass, spring stiffness, and friction (damping). You can drag
the mass with your mouse to change the starting position.
</p>

<p>The math behind the simulation is shown below.  Also available are:
<a href="https://github.com/myphysicslab/myphysicslab/blob/master/src/sims/springs/Spring2DApp.js">open source code</a>,
<a href="../develop/docs/myphysicslab.sims.springs.Spring2DApp.html">documentation</a> and a
<a href="../develop/build/sims/springs/Spring2DApp-en.html">simple-compiled version</a>
which is <a href="../develop/docs/Customizing.html">more customizable</a>.
</p>

<h2 id="physics">Physics of the 2-Dimensional Spring</h2>

<div class="image" style="width: 103px;">
<br>
<img src="spring2d.gif" width="100" height="117" alt="">
<br>
2D spring variables
</div>

<div style="margin-left:105px;">

<p>An immoveable (but draggable) anchor point has a spring and bob hanging below and
swinging in two dimensions. Regard the bob as a point mass. Define the following
variables:</p>


<ul class="vars">
    <li><span class="html-math inline-math">
<i>&theta;</i> =
</span> angle (<span class="html-math inline-math">
0 =
</span> vertical, increases counter-clockwise)</li>
    <li><span class="html-math inline-math">
<i>S</i> =
</span> spring stretch (displacement from rest length)</li>
    <li><span class="html-math inline-math">
<i>L</i> =
</span> length of spring</li>
    <li><span class="html-math inline-math">
<i>u</i> =
</span> position of bob</li>
    <li><span class="html-math inline-math">
<i>v</i> = <i>u</i>'= 
</span> velocity of bob</li>
    <li><span class="html-math inline-math">
<i>a</i> = <i>u</i>''= 
</span> acceleration of bob</li>
</ul>

<p>Define some constants:</p>

<ul class="vars">
    <li><span class="html-math inline-math">
<i>R</i> =
</span> rest length of spring</li>
    <li><span class="html-math inline-math">
<i>T</i> =
</span> position of anchor point</li>
    <li><span class="html-math inline-math">
<i>m</i> =
</span> mass of bob</li>
    <li><span class="html-math inline-math">
<i>k</i> =
</span> spring constant</li>
    <li><span class="html-math inline-math">
<i>b</i> =
</span> damping constant</li>
    <li><span class="html-math inline-math">
<i>g</i> =
</span> gravitational constant</li>
</ul>
</div>

<div class="image" style="width: 103px;">
<img src="i_j_vectors2.gif" width="74" height="73" alt=""><br>
I &amp; J unit vectors
</div>

<div style="margin-left:105px;">

<p>Note that for this simulation the vertical dimension increases downwards. We'll need
the standard unit vectors <span class="html-math inline-math">
<span class="vector">i</span>, <span class="vector">j</span>
</span>. We use bold and overline to indicate a
vector.</p>

<ul class="vars">
    <li><span class="html-math inline-math">
<span class="vector">i</span> =
</span> unit vector in horizontal direction</li>
    <li><span class="html-math inline-math">
<span class="vector">j</span> =
</span> unit vector in vertical (down) direction</li>
</ul>
</div>

<p style="clear: both;">There are three vector forces acting on the bob:</p>

<ul class="vars">
    <li><span class="html-math inline-math">
<span class="vector">F</span><sub>gravity</sub> = <i>m</i> <i>g</i> <span class="vector">j</span> =
</span> <span class="text">gravity acting straight down</span></li>
    <li><span class="html-math inline-math">
<span class="vector">F</span><sub>spring</sub> = &minus;<i>k</i> <i>S</i> (sin <i>&theta;</i> <span class="vector">i</span> + cos <i>&theta;</i> <span class="vector">j</span>) =
</span>
      <span class="text">the spring pulling (or pushing) along the line from bob to anchor point.</span></li>
    <li><span class="html-math inline-math">
<span class="vector">F</span><sub>damping</sub> = &minus;<i>b</i> (<i>v<sub>x</sub></i> <span class="vector">i</span> + <i>v<sub>y</sub></i> <span class="vector">j</span>) =
</span>
      <span class="text">damping (friction) acting opposite to the direction of motion of the bob, ie. opposite to its velocity vector.</span></li>
</ul>

<p>Summing these forces and using Newton's second law we get:</p>

<p class="html-math display-equation">
<i>m</i> <span class="vector">a</span> = <span class="vector">F</span><sub>gravity</sub> + <span class="vector">F</span><sub>spring</sub> + <span class="vector">F</span><sub>damping</sub>
</p>

<p class="html-math display-equation">
<i>m</i> (<i>a<sub>x</sub></i> <span class="vector">i</span> + <i>a<sub>y</sub></i> <span class="vector">j</span>) = <i>m</i> <i>g</i> <span class="vector">j</span> &minus;
<span class="nobr"><i>k</i> <i>S</i> (sin <i>&theta;</i> <span class="vector">i</span> + cos <i>&theta;</i> <span class="vector">j</span>)</span> &minus;
<span class="nobr"><i>b</i> (<i>v<sub>x</sub></i> <span class="vector">i</span> + <i>v<sub>y</sub></i> <span class="vector">j</span>)</span>
</p>

<p>We can write the horizontal and vertical components of the above as separate
equations. This gives us two simultaneous equations. We also divide each side by
<span class="html-math inline-math">
<i>m</i>
</span>.</p>

<table class="html-math numbered-equation"><tr><td class="emphasized">
<i>a<sub>x</sub></i> = &minus; <sup><i>k</i></sup>&frasl;<sub><i>m</i></sub> <i>S</i> sin <i>&theta;</i> &minus; <sup><i>b</i></sup>&frasl;<sub><i>m</i></sub> <i>v<sub>x</sub></i>

</td><td class="equation-number">(1a)</td></tr></table>

<table class="html-math numbered-equation"><tr><td class="emphasized">
<i>a<sub>y</sub></i> = <i>g</i> &minus; <sup><i>k</i></sup>&frasl;<sub><i>m</i></sub> <i>S</i> cos <i>&theta;</i> &minus; <sup><i>b</i></sup>&frasl;<sub><i>m</i></sub> <i>v<sub>y</sub></i>

</td><td class="equation-number">(1b)</td></tr></table>

<p>These are the equations of motion. It only remains to show how <span class="html-math inline-math">
<i>S</i> sin <i>&theta;</i>
</span> and
<span class="html-math inline-math">
<i>S</i> cos <i>&theta;</i>
</span> are functions of the position of the bob. The displacement of the
spring <span class="html-math inline-math">
<i>S</i>
</span> is the current length of the spring minus the rest length.</p>


<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
<i>S</i> = <i>L</i> &minus; <i>R</i>

</td><td class="equation-number">(2)</td></tr></table>

<p>From the pythagorean theorem we can get the length of the spring <span class="html-math inline-math">
<i>L</i>
</span> in terms
of from the position of the bob, <span class="html-math inline-math">
<i>u</i>
</span>, and the position of the anchor point,
<span class="html-math inline-math">
<i>T</i>
</span>.</p>


<p>$$L = \sqrt{(u_x - T_x)^2 + (u_y - T_y)^2} \tag{3}$$</p>

<p>The sine and cosine of the angle <span class="html-math inline-math">
<i>&theta;</i>
</span> are:</p>

<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
sin <i>&theta;</i> = (<i>u<sub>x</sub></i> &minus; <i>T<sub>x</sub></i>)/<i>L</i>

</td><td class="equation-number">(4a)</td></tr></table>

<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
cos <i>&theta;</i> = (<i>u<sub>y</sub></i> &minus; <i>T<sub>y</sub></i>)/<i>L</i>

</td><td class="equation-number">(4b)</td></tr></table>



<h2 id="numerics">Numerical Solution of the 2-Dimensional Spring</h2>

<p>To solve the equations of motion numerically, so that we can drive the simulation,
we use the <a href="../explain/runge-kutta-en.html">Runge Kutta method</a>
for solving sets of ordinary differential equations. Since the Runge-Kutta method only
works with <a href="../explain/classify-diff-eq-en.html">first-order</a>
differential equations, we convert the two second-order equations (1) to the following
four first-order equations.</p>

<p class="html-math display-equation">
<i>u<sub>x</sub></i>' = <i>v<sub>x</sub></i>
</p>

<p class="html-math display-equation">
<i>u<sub>y</sub></i>' = <i>v<sub>y</sub></i>
</p>

<p class="html-math display-equation">
<i>v<sub>x</sub></i>' = &minus; <sup><i>k</i></sup>&frasl;<sub><i>m</i></sub> <i>S</i> sin <i>&theta;</i> &minus; <sup><i>b</i></sup>&frasl;<sub><i>m</i></sub> <i>v<sub>x</sub></i>
</p>

<p class="html-math display-equation">
<i>v<sub>y</sub></i>' = <i>g</i> &minus; <sup><i>k</i></sup>&frasl;<sub><i>m</i></sub> <i>S</i> cos <i>&theta;</i> &minus; <sup><i>b</i></sup>&frasl;<sub><i>m</i></sub> <i>v<sub>y</sub></i>
</p>

<p>Keep in mind that <span class="html-math inline-math">
<i>S</i> sin <i>&theta;</i>
</span> and <span class="html-math inline-math">
<i>S</i> cos <i>&theta;</i>
</span> are functions of the
position of the bob, <span class="html-math inline-math">
<i>u<sub>x</sub></i>, <i>u<sub>y</sub></i>
</span>, as given in equations (2-4).</p>


<!--h2>TO DO:</h2>

<ul>
  <li>Does Y really increase downwards??? It doesn't in the graph, so should change
    the equations here to match what the sim is doing.</li>
</ul-->


<p id="page_history">
  This web page was first published April 2001.
</p>
