<!DOCTYPE html>
<html lang="es">
<head>
<title lang="es">Solución numérica de ecuaciones diferenciales</title>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../common/stylesheet1.css">

<script type="text/javascript" async
  src="../../mathjax/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
</head>
<body>

<h1 lang="es">Solución numérica de ecuaciones diferenciales</h1>

<div id="header_nav">
<a class="nav_link"
   href="classify-diff-eq-es.html">anterior</a>
<a class="nav_link"
   href="runge-kutta-es.html">siguiente</a>
</div>
<ul id="header_bar">
</ul>

<p class="introduction">En el proceso de creación de una simulación física</a>, comenzamos inventando un modelo matemático y encontrando las ecuaciones diferenciales que encarnan la física. El siguiente paso es <em>hacer que la computadora resuelva las ecuaciones</em>, un proceso que se conoce con el nombre de <em>análisis numérico</em>.</p>



<h2 id="analytic">Solución analítica</h2>

<p>Para modelos simples, se puede usar cálculo, trigonometría y otras técnicas matemáticas para encontrar una función que sea la solución exacta de la ecuación diferencial. Esto se llama la <em>solución analítica</em> (porque usa el análisis para resolverlo). También se conoce como solución de <em>formato cerrado</em>. (Por cierto, las clases universitarias sobre ecuaciones diferenciales tienen que ver con encontrar soluciones analíticas).</p>

<p>Se prefiere una solución analítica porque puede obtener una idea de la ecuación. Por ejemplo, en la <a href="../SingleSpringApp/SingleSpringApp-es.html#analytic">solución analítica de la simulación Single Spring</a> podemos ver cómo la masa <span class="html-math inline-math">
<i>m</i>
</span> o rigidez del resorte <span class="html-math inline-math">
<i>k</i>
</span> afecta la frecuencia de oscilación, con solo mirar la ecuación:</p>

<p>$$x(t) = x_0 \cos(\sqrt{k/m} \; t)$$</p>

<p>Por el contrario, con una solución numérica tendrías que realizar muchos experimentos para descubrir relaciones como esa; al igual que en la vida real, prepararía experimentos con diferentes masas o resortes, tomaría medidas y luego haría un gráfico que mostrara cómo varía la frecuencia para diferentes masas o rigidez del resorte.</p>


<h2>Solución numérica</h2>

<p>La mayoría de las simulaciones de física son demasiado complicadas para poder encontrar una solución analítica.
  En su lugar, usamos <a href="https://es.wikipedia.org/wiki/An%C3%A1lisis_num%C3%A9rico">Análisis Numérico</a> para encontrar una solución numérica aproximada, que es solo una lista de números. Los números son las variables del modelo en cada momento del tiempo. Por ejemplo, estos son los primeros momentos de la <a href="../SingleSpringApp/SingleSpringApp-es.html">simulación de Spring único</a></p>

<pre>
      t          x       v
  0.00000  &minus;2.00000  0.00000
  0.02500  &minus;1.99626  0.29906
  0.05000  &minus;1.98507  0.59552
  0.07500  &minus;1.96651  0.88827
  0.10000  &minus;1.94070  1.17623
  0.12500  &minus;1.90775  1.45837
  0.15000  &minus;1.86783  1.73364
  0.17500  &minus;1.82113  2.00105
  0.20000  &minus;1.76785  2.25965
  0.22500  &minus;1.70823  2.50851
  0.25000  &minus;1.64252  2.74675
</pre>
<p>Esta lista de números es lo que impulsa la representación visual de la simulación: para el valor actual del tiempo <span class="html-math inline-math">
<i>t</i>
</span> movemos el bloque a la posición dada por <span class="html-math inline-math">
<i>x</i>
</span> variable en ese momento.</p>

<p>¿Cómo funciona? ¿Cómo generamos esa lista de números?</p>

<p>Comenzamos con los valores iniciales de las variables, que es la primera fila de la tabla anterior. Luego usamos las ecuaciones diferenciales para la simulación para calcular las variables después de un período de tiempo muy breve. <em>La ecuación diferencial nos dice la tasa de cambio de cada variable en cualquier momento.</em> Al sumar pequeños cambios a lo largo del tiempo (también conocido como <em>integrar a lo largo del tiempo</em>), podemos predecir el futuro.</p>

<p>Para la simulación de resorte único, las ecuaciones diferenciales son:</p>

<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
<i>x</i>' = <i>v</i>

</td><td class="equation-number">(1)</td></tr></table>

<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
<i>v</i>' = &minus;<sup><i>k</i></sup>&frasl;<sub><i>m</i></sub> <i>x</i> &minus; <sup><i>b</i></sup>&frasl;<sub><i>m</i></sub> <i>v</i>

</td><td class="equation-number">(2)</td></tr></table>

<p>Los valores de los parámetros para la rigidez del resorte <span class="html-math inline-math">
<i>k</i>
</span>, masa <span class="html-math inline-math">
<i>m</i>
</span>, y amortiguación <span class="html-math inline-math">
<i>b</i>
</span> son:</p>

<p class="html-math display-equation">
<i>k</i> = 3.0<br>
<i>m</i> = 0.5<br>
<i>b</i> = 0.1<br>
</p>

<p>Con estos parametros, las ecuaciones (1) y (2) se simplifican a</p>

<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
<i>x</i>' = <i>v</i>

</td><td class="equation-number">(3)</td></tr></table>

<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
<i>v</i>' = &minus;6 <i>x</i> &minus; 0.2 <i>v</i>

</td><td class="equation-number">(4)</td></tr></table>


<p>Las condiciones iniciales en el momento <span class="html-math inline-math">
<i>t</i> = 0
</span> son</p>

<p class="html-math display-equation">
<i>x</i> = &minus;2.0<br>
<i>v</i> = 0.0
</p>

<p>Podemos encontrar la tasa de cambio de las variables en el tiempo <span class="html-math inline-math">
<i>t</i> = 0
</span> sustituyendo los valores anteriores en las ecuaciones (3) y (4)</p>

<p class="html-math display-equation">
<i>x</i>' = 0<br>
<i>v</i>' = &minus;6 (&minus;2) &minus; 0.2 (0) = +12
</p>

<p>Dado que conocemos los valores iniciales de las variables y sus tasas de cambio, podemos predecir los valores futuros. ¡Al menos por un período de tiempo muy corto en el futuro, suponiendo que las tasas de cambio no cambien demasiado!</p>

<h2>Método de integración numérica de Euler</h2>

<p>Para mostrar cómo funciona la integración numérica, usamos el método más simple posible: el método de Euler. Es simple pero no muy preciso. Mencionaremos métodos más precisos a continuación.</p>

<p>Al resolver las ecuaciones diferenciales (3) y (4), suponga que conocemos el estado del sistema en el momento <span class="html-math inline-math">
<i>t<sub>n</sub></i>
</span> para tener la posición <span class="html-math inline-math">
<i>x<sub>n</sub></i>
</span> y velocidad <span class="html-math inline-math">
<i>v<sub>n</sub></i>
</span>.</p>

<p>Para obtener el estado del sistema en ese momento <span class="html-math inline-math">
<i>t<sub>n+1</sub></i> = <i>t<sub>n</sub></i> + &Delta;<i>t</i>
</span>> después de una pequeña cantidad de tiempo <span class="html-math inline-math">
&Delta;<i>t</i>
</span> ha transcurrido:</p>

<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
<i>x<sub>n+1</sub></i> = <i>x<sub>n</sub></i> + &Delta;<i>t</i> <i>v<sub>n</sub></i>

</td><td class="equation-number">(5)</td></tr></table>

<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
<i>v<sub>n+1</sub></i> = <i>v<sub>n</sub></i> + &Delta;<i>t</i> (&minus; 6 <i>x<sub>n</sub></i> &minus; 0.2 <i>v<sub>n</sub></i>)

</td><td class="equation-number">(6)</td></tr></table>

<p>Las ecuaciones (5) y (6) usan las tasas dadas por las ecuaciones diferenciales (3) y (4) para hacer una estimación cruda del nuevo valor después de la pequeña cantidad de que el tiempo <span class="html-math inline-math">
&Delta;<i>t</i>
</span> ha transcurrido.</p>


<p>Ahora podemos usar las ecuaciones (5) y (6) para hacer las predicciones numéricas. Empezamos en el tiempo <span class="html-math inline-math">
<i>t</i> = 0
</span> con</p>

<p class="html-math display-equation">
<i>x<sub>0</sub></i> = &minus;2<br>
<i>v<sub>0</sub></i> = 0
</p>

<p>Con <span class="html-math inline-math">
<i>n</i> = 0
</span> y un pequeño paso de tiempo de <span class="html-math inline-math">
&Delta;<i>t</i> = 0.025
</span>, las ecuaciones (5) y (6) dan el estado en el momento <span class="html-math inline-math">
<i>t<sub>1</sub></i> = <i>t<sub>0</sub></i> +&Delta;<i>t</i> = 0.025
</span></p>

<p class="html-math display-equation">
<i>x<sub>1</sub></i> = <i>x<sub>0</sub></i> + 0.025 <i>v<sub>0</sub></i> = &minus;2 + 0.025 * 0 = &minus;2<br>
<i>v<sub>1</sub></i> = <i>v<sub>0</sub></i> + 0.025 (&minus;6 <i>x<sub>0</sub></i> &minus; 0.2 <i>v<sub>0</sub></i>) = 0 + 0.025 (&minus;6 (&minus;2) &minus; 0.2 (0)) = 0.3
</p>

<p>Con <span class="html-math inline-math">
<i>n</i> = 1
</span> en las ecuaciones (5) y (6) podemos obtener el estado en el momento <span class="html-math inline-math">
<i>t<sub>2</sub></i> = <i>t<sub>1</sub></i> + &Delta;<i>t</i> = 0.050
</span></p>

<p class="html-math display-equation">
<i>x<sub>2</sub></i> = <i>x<sub>1</sub></i> + 0.025 <i>v<sub>1</sub></i> = &minus;2 + 0.025 (0.3) = &minus;1.9925<br>
<i>v<sub>2</sub></i> = <i>v<sub>1</sub></i> + 0.025 (&minus;6 <i>x<sub>1</sub></i> &minus; 0.2 <i>v<sub>1</sub></i>) = 0.3 + 0.025 (&minus;6 (&minus;2) &minus; 0.2 (0.3)) = 0.5985
</p>

<p>Con <span class="html-math inline-math">
<i>n</i> = 2
</span> en las ecuaciones (5) y (6) podemos obtener el estado en el momento <span class="html-math inline-math">
<i>t<sub>3</sub></i> = <i>t<sub>2</sub></i> + &Delta;<i>t</i> = 0.075
</span></p>

<p class="html-math display-equation">
<i>x<sub>3</sub></i> = <i>x<sub>2</sub></i> + 0.025 <i>v<sub>2</sub></i> = &minus;1.9925 + 0.025 (0.5985) = &minus;1.9775375<br>
<i>v<sub>3</sub></i> = <i>v<sub>2</sub></i> + 0.025 (&minus;6 <i>x<sub>2</sub></i> &minus; 0.2 <i>v<sub>2</sub></i>)
= 0.5985 + 0.025 (&minus;6 (&minus;1.9925) &minus; 0.2 (0.5985)) = 0.8943825
</p>

<p>Nuestra solución numérica aproximada hasta ahora:</p>

<pre>
      t         x        v
  0.00000  &minus;2.00000  0.00000
  0.02500  &minus;2.00000  0.30000
  0.05000  &minus;1.99250  0.59850
  0.07500  &minus;1.97754  0.89438
</pre>
<p>Aquí de nuevo para comparar está la solución que se calcula en la simulación Single Spring usando el <a href="runge-kutta-es.html">Método Runge-Kutta</a></p>

<pre>
      t         x        v
  0.00000  &minus;2.00000  0.00000
  0.02500  &minus;1.99626  0.29906
  0.05000  &minus;1.98507  0.59552
  0.07500  &minus;1.96651  0.88827
</pre>
<p>¡Nuestra sencilla solución no está tan lejos! Pero si comparamos esto con un ejemplo del mundo real de un resorte y una masa reales, veríamos que este método es muy impreciso. O si observamos si la energía se conserva, también veremos que tiene poca precisión. Para muchas simulaciones, este método es tan malo que se vuelve inestable y "explotará" con soluciones que van al infinito.</p>



<h2>Otros métodos numéricos</h2>

<p>Existen varios métodos para integrar una ecuación diferencial a lo largo del tiempo. Tienen varias compensaciones de precisión frente a costo computacional. El artículo de Wikipedia <a href="https://es.wikipedia.org/wiki/M%C3%A9todos_num%C3%A9ricos_para_ecuaciones_diferenciales_ordinarias">Métodos numéricos para ecuaciones diferenciales ordinarias</a> describe varios de ellos.</p>

<p>Los métodos utilizados en las simulaciones de myphysicslab son:</p>

<ul>
  <li>El método de Euler. Este es el método simple que se muestra en esta página, tiene muy poca precisión.</li>

  <li>El método de Euler modificado. Este es el método más simple que tiene una precisión y estabilidad razonables.</li>

  <li>El <a href="runge-kutta-es.html">Método Runge-Kutta</a>. Esto tiene una precisión muy alta con alrededor del doble de la cantidad de cálculo necesaria para el método de Euler modificado.</li>

</ul>

<p>Estos métodos numéricos se definen con ecuaciones que pueden resultar un poco confusas. Para acostumbrarse a la notación, así es como se podría redefinit el método simple de Euler que usamos anteriormente. En forma más general podemos escribir las ecuaciones (5) y (6) así:</p>

<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
<i>x<sub>n+1</sub></i> = <i>x<sub>n</sub></i> + &Delta;<i>t</i>&nbsp; <i>f</i> (<i>x<sub>n</sub></i>, <i>v<sub>n</sub></i>)

</td><td class="equation-number">(7)</td></tr></table>

<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
<i>v<sub>n+1</sub></i> = <i>v<sub>n</sub></i> + &Delta;<i>t</i>&nbsp; <i>g</i>(<i>x<sub>n</sub></i>, <i>v<sub>n</sub></i>)

</td><td class="equation-number">(8)</td></tr></table>

<p>donde las funciones <span class="html-math inline-math">
<i>f</i>, <i>g</i>
</span> son las ecuaciones diferenciales que estamos resolviendo escritas así:</p>

<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
<i>x</i>' = <i>f</i> (<i>x</i>, <i>v</i>)

</td><td class="equation-number">(9)</td></tr></table>

<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
<i>v</i>' = <i>g</i>(<i>x</i>, <i>v</i>)

</td><td class="equation-number">(10)</td></tr></table>

<p>El problema con el solucionador numérico simple del método de Euler es que solo usa la tasa de cambio al <em>comienzo</em> del período de tiempo desde <span class="html-math inline-math">
<i>t<sub>n</sub></i>
</span> a <span class="html-math inline-math">
<i>t<sub>n</sub></i> + &Delta;<i>t</i>
</span>. Sin embargo, esa tasa de cambio (la derivada) <em>¡cambia en sí misma durante este período!</em> Los métodos numéricos más precisos estiman cómo cambian las derivadas en las ecuaciones (9) y (10) durante el período de tiempo.</p>


<p>También hay un término medio entre estos dos métodos. Hay muchas ecuaciones <em>no lineales</em> para las que no es posible encontrar una solución analítica.
Sin embargo, existen técnicas en las que puede encontrar análisis analíticos aproximados. Son
soluciones que están cerca de la verdadera solución, al menos dentro de un cierto rango. Por ejemplo, un
método denominado <em>método de perturbación</em>. La ventaja sobre una solución numérica es que
la solución (con una ecuación) que termines teniendo (en lugar de solo una larga lista de números) es que se pueden obtener ideas de ella.
</p>


<div id="footer2" >
  <div id="copyright">
    &copy; <a href="mailto:erikn@myPhysicsLab.com"
    title="send comments to Erik Neumann">
    Erik Neumann</a>,  2004-2016<br>
    <span id="revised_date">revisado Feb 6 2021</span>
  </div>
  <a class="nav_link" href="classify-diff-eq-es.html">anterior</a>
  <a class="nav_link" href="runge-kutta-es.html">siguiente</a>
</div>
</body>
</html>
