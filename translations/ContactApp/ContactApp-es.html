<!DOCTYPE html>
<html lang="es">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="stylesheet.css">
<link rel="stylesheet" type="text/css" href="../common/stylesheet1.css">
<title>Fuerzas de Contacto de Cuerpos Rígidos</title>

<script>
  document.getElementsByTagName("html")[0].style.visibility = "hidden";
</script>
</head>
<body>
  <h1>Fuerzas de Contacto de Cuerpos Rígidos</h1>
<ul id="header_bar" class="horiz_tabs">
  <li class="sim selected">Simulador</li>
  <li class="graph ">Gráfico</li>
  <li class="time_graph">Gráfico de tiempo</li>
  <li class="multi_graph">Gráfico múltiple</li>
</ul>




<div id="container" class="control_container">
  <div id="div_graph" >
  </div>
  <div id="div_time_graph" >
  </div>
  <div id="sim_applet" >
  </div>
  <div id="sim_controls" class="control_group">
  </div>
  <div id="graph_controls" class="control_group">
  </div>
  <div id="time_graph_controls" class="control_group">
  </div>
  <p>
  <label id="label_show_sim">
    <input type="checkbox" id="show_sim">show sim
  </label>
   <label id="label_terminal">
    <input type="checkbox" id="show_terminal">terminal
   </label>
   <div id="div_terminal">
     <textarea id="term_output" cols=80 rows=20 wrap="soft"></textarea> <br>
     <label style="display:inline-block">command &gt;
       <input type="text" id="term_input" size="80">
     </label>
   </div>
</div>

<h2>Acerca de</h2>

<p class="introduction">
  Esta simulación utiliza el <a href="../explain/physics-engine-es.html">Motor de Física de Cuerpo Rígido 2D</a>
  para mostrar objetos chocando y empujando unos contra otros. Se basa en la simulación de
<a href="../ImpulseApp/ImpulseApp-es.html">Colisiones de Cuerpos Rígidos</a>, pero se trata de
fuerzas de contacto estables donde los objetos presionan contra el suelo, la pared o entre sí.
</p>

<p class="instructions">
  Haga clic cerca de un objeto para ejercer una fuerza de resorte con el mouse. Con el se teclado puede
  controlar cuatro "propulsores". Las teclas S,D,F,E controlan el empuje en el bloque 1. Él
  las teclas J, K, L, I, y también las teclas de flecha, controlan el empuje en el bloque 2. También se
  puede establecer la gravedad, la elasticidad (rebote) y la amortiguación (fricción). Se puede elegir
  de uno a seis objetos.</p>

<p>También está disponible:
<a href="https://github.com/myphysicslab/myphysicslab/blob/master/src/sims/engine2D/ContactApp.js">código fuente</a>,
documentación y una
versión compilada simple
que es más personalizable.
</p>


<p>Intenta reorganizar los bloques para que se apoyen unos contra otros en varios ángulos, o
  apilando los bloques. ¡Verás que son muy resbaladizos y difíciles de apilar!
  Esto se debe a que no hay fricción de contacto en esta simulación.</p>

<p> Las fuerzas de contacto se muestran como líneas rojas que aparecen en las esquinas de los
  objetos. Las fuerzas de contacto vienen en pares que son iguales y opuestos, pero solo uno de cada
  par se muestra aquí.</p>

<p> Acerca de la fricción y el amortiguamiento: En esta simulación, los contactos entre objetos no tienen
  fricción alguna, por lo que pueden deslizarse entre sí fácilmente. El parámetro amortiguación
  que se puede modificar (puede que tenga que hacer clic en el botón "mostrar controles" para
  ver el parámetro de amortiguamiento) tiene que ver con el movimiento de los objetos a través del espacio
  -- la amortiguación hace que parezca que los objetos se mueven a través de un jarabe espeso, o que
  hay fricción entre la superficie de fondo y los objetos.</p>


<h2 id="calculate_contact_forces_overview">Cómo calcular las fuerzas de contacto:
   Resumen</h2>

<p>
  ¡Puede sorprenderle que hacer que los objetos descansen en el suelo es un problema muy desafiante!
</p>

<p>Es porque las <em>fuerzas de contacto</em> son difíciles de descifrar. Otras
  fuerzas son mucho más simples porque solo dependen de la posición de uno o dos objetos.
  Por ejemplo, la fuerza de un muelle entre dos objetos depende sólo de la posición de
  los puntos finales del muelle. Pero las fuerzas de contacto entre objetos dependen de todas las
  otras fuerzas sobre los objetos y cómo descansan unos contra otros de una forma compleja.</p>

<p>El software (una clase llamada ContactSim)
  descrito aquí para calcular las fuerzas de contacto trabaja en estrecha colaboración con el software que maneja las colisiones, consulte
<a href="../ImpulseApp/ImpulseApp-es.html">Colisiones de Cuerpo Rígido</a>. Ese software (una superclase llamada ImpulseSim)
se encarga de las colisiones. Como resultado, no debería haber
colisiones que ocurran cuando el código de fuerza de contacto está activo, porque el código de colisión
detecta colisiones, retrocede en el tiempo justo antes de la colisión y aplica un
impulso apropiado para hacer que los objetos reboten (invierte sus velocidades).
La superclase también calcula los efectos de las fuerzas externas que actúan sobre los objetos, como
gravedad, empuje, resorte y amortiguamiento. (Curiosamente, son esas fuerzas externas las que
causan las fuerzas de contacto: sin ellas no habría fuerzas que empujaran los objetos entre sí.)</p>

<p> La idea es calcular la cantidad exacta de fuerza necesaria en cada contacto para
  <em>apenas</em> evitar que los objetos penetren. Estas fuerzas se calculan
  en el método <code>evaluate</code> de la clase <code>ContactSim</code>, que es
  llamado repetidamente por el solucionador de ecuaciones diferenciales para encontrar las aceleraciones de los
  objetos. El solucionador de ecuaciones diferenciales utiliza esa información para avanzar en el estado de
  el mundo a través del tiempo. Al ingresar a este método <code>evaluate</code> se nos da las
  posiciones y velocidades actuales de cada objeto, que es información requerida para
  averiguar dónde están los puntos de contacto y la geometría de las fuerzas de contacto entre
  objetos.</p>

<p> Primero encontramos todos los contactos de reposo entre objetos. Los criterios son: una esquina
  debe estar muy cerca de un borde y moverse muy lentamente (en la dirección perpendicular a
  el borde). Usando estos criterios, armamos una lista de puntos de contacto. Para cada
  contacto, almacenamos información como: cuáles son los dos objetos que están en contacto,
  cuál es la normal (vector perpendicular) al borde, donde está el punto de contacto
  relativo a cada objeto, etc. </p>


<!-- <div class="centered_image"> -->
<img src="contact_1.png" width="301" height="298" alt=""><br>
2 cuerpos en contacto
<!-- </div> -->


<p> Considere los dos objetos en contacto en la figura. El punto de contacto en el cuerpo 1 es
  la esquina etiquetada <span class="html-math inline-math">
<b>p</b><sub>1</sub>
</span>, el punto de contacto en el cuerpo 2 está en el borde y etiquetado
<span class="html-math inline-math">
<b>p</b><sub>2</sub>
</span>. Sea <span class="html-math inline-math">
<i>d</i>
</span> la distancia entre los dos puntos, de modo que
<span class="html-math inline-math">
<i>d</i> = |<b>p</b><sub>1</sub> &minus; <b>p</b><sub>2</sub>|
</span>. Sea <span class="html-math inline-math">
<b>n</b>
</span> el vector normal que señala desde el cuerpo
2 que es perpendicular al borde. En el siguiente diagrama vemos las dos fuerzas de contacto
que se desarrollan en el punto de contacto. Hay una fuerza de contacto <span class="html-math inline-math">
<i>f</i> <b>n</b>
</span> que actúa sobre el cuerpo 1 en el punto de contacto para evitar que penetre en el cuerpo 2. Por
La tercera ley de Newton también existe una fuerza igual pero opuesta <span class="html-math inline-math">
&minus;<i>f</i> <b>n</b>
</span> que actúa sobre el cuerpo 2 en el punto de contacto para evitar que penetre en el cuerpo 1.</p>

<!-- <div class="centered_image"> -->
<img src="contact_3.png" width="301" height="298" alt=""><br>
2 cuerpos con fuerzas de contacto
<!-- </div> -->


<p>Lo que queremos encontrar son las fuerzas de contacto (actualmente desconocidas), como
<span class="html-math inline-math">
<i>f</i> <b>n</b>
</span>, que <em>apenas</em> evitará que los objetos se aceleren
entre sí, contrarrestando todas las demás fuerzas (como la gravedad) que tienden a
juntar los objetos.</p>

<p>Nos enfocamos en la distancia de contacto <span class="html-math inline-math">
<i>d</i>
</span>, el espacio entre los puntos que están en
contacto. Debido a que los objetos están en contacto, tenemos que <span class="html-math inline-math">
<i>d</i> = 0
</span> (dentro de
tolerancia numérica). Un valor de <span class="html-math inline-math">
<i>d</i> &lt; 0
</span> indicaría que los objetos se están
 penetrando entre ellos. Un valor de <span class="html-math inline-math">
<i>d</i> &gt; 0
</span> indicaría que los objetos no están en
contacto pero separados por una distancia <span class="html-math inline-math">
<i>d</i>
</span>.</p>

<p>La tasa de cambio de la distancia de contacto es la velocidad  <span class="html-math inline-math">
<i>d'</i>
</span>. Debido a que los objetos están en contacto y en reposo tenemos que <span class="html-math inline-math">
<i>d'</i> = 0
</span> (dentro de valores de tolerancia). Este fue uno de los criterios para seleccionar el conjunto de puntos de contacto en reposo.
Tenga en cuenta que los objetos pueden deslizarse uno contra el otro, porque solo nos importa
el movimiento en la dirección de la normal (perpendicular al borde).</p>

<p>Lo que más nos interesa es <span class="html-math inline-math">
<i>d''</i>
</span>, la aceleración del hueco entre ellos. Sin
fuerzas de contacto encontraremos que <span class="html-math inline-math">
<i>d''</i> &lt; 0
</span> para la mayoría de los puntos de contacto,
lo que significa que sin ninguna fuerza de contacto, los objetos caerán entre sí y
penetrarían.</p>

<p>Lo que hace que calcular las fuerzas de contacto sea algo complicado es que todas están
  interrelacionadas. Esto se debe a que se puede tener una disposición compleja de objetos que descansan entre sí.
  La solución consiste en encontrar un conjunto de ecuaciones que capture exactamente cómo
  cada fuerza de contacto afecta a cada espacio. Luego resolvemos las ecuaciones para encontrar fuerzas que se
  establecen exactamente  <span class="html-math inline-math">
<i>d''</i> = 0
</span> en cada punto de contacto. En realidad, también permitimos
<span class="html-math inline-math">
<i>d''</i> > 0
</span> lo que significa que los objetos se están separando y por lo tanto no hay
fuerza de contacto en ese punto de contacto en particular.</p>

<p>Una vez que hayamos encontrado la fuerza exacta en cada contacto que preservará el reposo
  en el contacto (evitando que los objetos se aceleren entre sí) luego aplicamos esa
  fuerza a cada objeto. Esto da como resultado cambios en las aceleraciones de los objetos. Nosotros
  luego devolvemos el control al solucionador de ecuaciones diferenciales que continúa evolucionando la
  simulación a lo largo del tiempo usando esas nuevas aceleraciones. Pero ahora las aceleraciones están
  modificadas para que los objetos permanezcan en contacto y en reposo como se desea.</p>




<h2 id="calculate_contact_forces_detail">Cálculo de las fuerzas de contacto: en detalle</h2>

<p>Este software para calcular las fuerzas de contacto se llama <code>ContactSim</code>; es una subclase de la clase <code>ImpulseSim</code> que se describe en la página sobre <a href="../ImpulseApp/ImpulseApp-es.html">Colisiones de Cuerpo Rígido</a>.
  Lo siguiente se basa en las explicaciones allí documentadas.</p>

<p>Los algoritmos utilizados aquí se basan
  en dos artículos de <a href="http://www.cs.cmu.edu/~baraff/papers/">David Baraff</a>:</p>

<ul>

<li>[Baraff-1] David Baraff,
  <a href="http://www.cs.cmu.edu/~baraff/sigcourse/notesd2.pdf">An Introduction to
  Physically Based Modeling: Rigid Body Simulation II - Nonpenetration Constraints</a>.
  Estas son notas de conferencias de
  <a href="http://www.cs.cmu.edu/~baraff/sigcourse/">Physically Based Modeling:
  Principles and Practice (Online Siggraph '97 Course Notes)</a>.
  Tenga en cuenta que hay un error tipográfico en la página D62: en varios lugares donde ve
  "una fuerza de <i>j n<sub>j</sub>(t<sub>0</sub>)</i>" debería decir
  "una fuerza de <i>f<sub>j</sub> n<sub>j</sub>(t<sub>0</sub>)</i>".
</li>

<li>[Baraff-2] David Baraff.
  <a href="http://www.cs.cmu.edu/~baraff/papers/sig94.pdf">Fast contact force
  computation for nonpenetrating rigid bodies.</a> Computer Graphics Proceedings,
  Annual Conference Series: 23-34, 1994. 12 pages.
</li>

</ul>

<p>Ver también <a href="../ReactionPendulumApp/ReactionPendulumApp-es.html">Reaction Force Pendulum</a> que es un
  ejemplo más simple de calcular las fuerzas de contacto utilizando las matemáticas que se muestran en esta página.
</p>

<p>Supongamos que tenemos un conjunto de <span class="html-math inline-math">
<i>n</i>
</span> contactos en algún orden particular (pero arbitrario). Defina las siguientes variables:</p>

<ul class="vars">

	<li><i>n</i> = número de contactos.</li>

	<li><i>d<sub>i</sub>''</i> = aceleración de la distancia de contacto del <i>i</i>-ésimo contacto.</li>

	<li><b>a</b> = longitud <i>n</i> vector de aceleraciones de distancias de contacto,
    de modo que <i>a<sub>i</sub></i> = <i>d<sub>i</sub>''</i></li>

	<li><b>f</b> = longitud <i>n</i> vector de magnitudes de fuerza de contacto (por determinar)</li>

	<li><b>b</b> = vector de longitud <i>n</i> que proporciona aceleraciones de distancia de contacto debidas a
    fuerzas externas (gravedad, empuje, etc.)</li>

	<li><b>A</b> = an <i>n</i> &times; <i>n</i> matriz que especifica cómo las fuerzas de contacto
    afectan la aceleración de las distancias de contacto</li>

	<li><i>a<sub>i j</sub></i> = el elemento de <b>A</b> en la <i>i</i>-ésima fila y <i>j</i>-ésima columna.</li>

</ul>
<p>Nuestro objetivo es establecer y resolver (sujeto a ciertas restricciones) la matriz
  ecuación</p>

<table class="html-math numbered-equation"><tr><td class="emphasized">
 <b>a</b> = <b>A</b> <b>f</b> + <b>b</b>

</td><td class="equation-number">(1)</td></tr></table>

<p>La entrada de la matriz <i>a<sub>i j</sub></i> indica cuánto cambia <i>d<sub>i</sub>''</i> a partir de un cambio de unidad en <i>f<sub>j</sub></i>. Si hacemos
  la multiplicación de matrices en la ecuación (1) vemos que la aceleración de la <i>i</i>-ésima distancia de contacto viene dada por</p>
<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
  <i>d<sub>i</sub>''</i> = <i>a<sub>i 1</sub></i> <i>f<sub>1</sub></i> + <i>a<sub>i 2</sub></i> <i>f<sub>2</sub></i> +. . . + <i>a<sub>i j</sub></i> <i>f<sub>j</sub></i> + . . . + <i>a<sub>i n</sub></i> <i>f<sub>n</sub></i> + <i>b<sub>i</sub></i>

</td><td class="equation-number">(2)</td></tr></table>

<p>Esto dice que la aceleración de <span class="html-math inline-math">
<i>i</i>
</span>-ésima distancia de contacto es una función
de las fuerzas de contacto <span class="html-math inline-math">
<i>f<sub>1</sub></i>, <i>f<sub>2</sub></i>,..., <i>f<sub>n</sub></i>
</span> y las fuerzas externas en bi. Podemos
averiguar el <span class="html-math inline-math">
<i>a<sub>i j</sub></i>
</span> y <span class="html-math inline-math">
<i>b<sub>i</sub></i>
</span> (ver más abajo). El <span class="html-math inline-math">
<i>d<sub>i</sub></i>''
</span> necesita llegar a cero o positivo, porque los objetos no pueden acelerarse entre sí (son
cuerpos rígidos que no se interpenetran). Así que las únicas incógnitas son las fuerzas de contacto.
<span class="html-math inline-math">
<i>f<sub>i</sub></i>
</span>, y podemos resolver este sistema de ecuaciones simultáneas para encontrarlas.</p>

<!-- <div class="centered_image"> -->
<img src="contact_2.png" width="602" height="404" alt=""><br>
5 cuerpos, 4 puntos de contacto, 8 fuerzas de contacto
<!-- </div> -->

<p>Para ilustrar cómo se calculan la matriz <b>A</b> y el vector <b>b</b>, considere la
  figura de arriba, tenemos 5 cuerpos que están en contacto y en reposo con 4 puntos de contacto donde
  se muestran las fuerzas de contacto resultantes. (Tenga en cuenta que las normales <b><b>n</b></b><i><sub>i</sub></i> son siempre perpendiculares
  a un borde y por convención apuntan desde el objeto; esto determina qué fuerzas
  tienen signos negativos). Los puntos de contacto están numerados de acuerdo con las fuerzas de contacto,
  para que la fuerza de contacto <i>f<sub>1</sub></i> <b><b>n</b></b><i><sub>1</sub></i> esté en el contacto 1, etc. Centrándose en el contacto 2 (entre cuerpos
  1 y 2), de la ecuación (2) podemos escribir</p>
<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
  <i>d<sub>2</sub>''</i> = <i>a<sub>2,1</sub></i> <i>f<sub>1</sub></i> + <i>a<sub>2,2</sub></i> <i>f<sub>2</sub></i> + <i>a<sub>2,3</sub></i> <i>f<sub>3</sub></i> + <i>a<sub>2,4</sub></i> <i>f<sub>4</sub></i> + <i>b<sub>2</sub></i>

</td><td class="equation-number">(3)</td></tr></table>

<p>Considere qué está afectando a la aceleración de la distancia de contacto <i>d<sub>2</sub>''</i>. Cualquier cosa
  que acelera el cuerpo 1 o el cuerpo 2 puede afectar <i>d<sub>2</sub>''</i>. Aquí hay una lista de estas fuentes de
  aceleración de <i>d<sub>2</sub>''</i>  y dónde terminan en la ecuación (3).</p>
<ul>

  <li>Para todas las fuerzas sin contacto (gravedad, empuje, etc.) que actúan actualmente sobre el cuerpo
    1, calculamos cuál es la aceleración resultante de la esquina del cuerpo 1 en el contacto
    2; esto se agrega a <span class="html-math inline-math">
<i>b<sub>2</sub></i>
</span>.</li>

 <li>Del mismo modo, para todas las fuerzas sin contacto (gravedad, empuje, etc.) actualmente
  actuando sobre el cuerpo 2, calculamos cuál es la aceleración resultante del punto sobre
  cuerpo 2 en el contacto 2; esto se agrega a <span class="html-math inline-math">
<i>b<sub>2</sub></i>
</span>.</li>

 <li>Con respecto a la fuerza de contacto <span class="html-math inline-math">
<i>f<sub>1</sub></i> <b><b>n</b></b><i><sub>1</sub></i>
</span>, para un cambio de unidad en<span class="html-math inline-math">
<i>f<sub>1</sub></i>
</span> calculamos cuál sería la aceleración resultante del punto en el cuerpo 2 en el contacto
2; esto se pone en <span class="html-math inline-math">
<i>a<sub>2,1</sub></i>
</span>.</li>

 <li>Con respecto a la fuerza de contacto <span class="html-math inline-math">
<i>f<sub>2</sub></i> <b><b>n</b></b><i><sub>2</sub></i>
</span>, para un cambio de unidad en f2 calculamos cual sería la aceleración resultante
de la esquina del cuerpo 1 en el contacto 2; esto se pone <span class="html-math inline-math">
<i>a<sub>2,2</sub></i>
</span>.</li>

 <li>Con respecto a la fuerza de contacto <span class="html-math inline-math">
&minus;<i>f<sub>2</sub></i> <b><b>n</b></b><i><sub>2</sub></i>
</span>, para un cambio de unidad en <span class="html-math inline-math">
<i>f<sub>2</sub></i>
</span> calculamos cuál sería la aceleración resultante del punto en el cuerpo 2 en el contacto
2; esto se <em>agrega</em> a <span class="html-math inline-math">
<i>a<sub>2,2</sub></i>
</span>.</li>

 <li>Con respecto a la fuerza de contacto <span class="html-math inline-math">
&minus;<i>f<sub>3</sub></i> <b><b>n</b></b><i><sub>3</sub></i>
</span>, para un cambio de unidad en<span class="html-math inline-math">
<i>f<sub>3</sub></i>
</span> calculamos cuál sería la aceleración resultante de la esquina del cuerpo 1 en el contacto
2; esto se pone en <span class="html-math inline-math">
<i>a<sub>2,3</sub></i>
</span>.</li>

 <li>Porque la fuerza de contacto <span class="html-math inline-math">
<i>f<sub>4</sub></i> <b><b>n</b></b><i><sub>4</sub></i>
</span> y <span class="html-math inline-math">
&minus;<i>f<sub>4</sub></i> <b><b>n</b></b><i><sub>4</sub></i>
</span> no afecta directamente
a los cuerpos 1 o 2, configuramos <span class="html-math inline-math">
<i>a<sub>2,4</sub></i> = 0
</span>.</li>

</ul>

<p>Espero que esto les dé una idea de cómo son la matriz <b>A</b> y el vector <b>b</b> y como son calculados.
  Los detalles completos sobre estos cálculos se dan a continuación en las secciones
<a href="#a_matrix">Cálculo de la Matriz <b>A</b></a> y
<a href="#b_vector">Cálculo del <b>b</b> Vector</a>.</p>

<p>Una vez que hemos encontrado la matriz <b>A</b> y el vector <b>b</b>, estamos listos para resolver la ecuación (1)
  para las magnitudes de fuerza desconocidas en el vector <b>f</b>, se está sujeto a las siguientes 3
  restricciones:</p>

<table class="html-math numbered-equation"><tr><td class="emphasized">
	<i>a<sub>i</sub></i> >= 0, &nbsp; <i>f<sub>i</sub></i> >= 0,  &nbsp; <b>a</b> &middot; <b>f</b> = 0

</td><td class="equation-number">(4)</td></tr></table>

<p>Las restricciones explicadas son:</p>

<ul>

  <li><span class="html-math inline-math">
<i>a<sub>i</sub></i> >= 0
</span> significa que no permitimos la interpenetración (que ocurre cuando
  <span class="html-math inline-math">
<i>a<sub>i</sub></i> &lt; 0
</span>).
  Requerimos todas las aceleraciones normales relativas entre cuerpos en los puntos de contacto ser cero (en contacto) o positivo (separando).
  </li>

  <li><span class="html-math inline-math">
<i>f<sub>i</sub></i> >= 0
</span> significa que requerimos que las fuerzas de contacto sean cero o positivas porque
solo pueden empujar, no tirar.
  </li>

  <li><span class="html-math inline-math">
<b>a</b> &middot; <b>f</b> = 0
</span> significa que, en cada punto de contacto, si hay un
fuerza de contacto entonces la aceleración es cero O si hay aceleración (separación) entonces
no hay fuerza de contacto. El punto en la ecuación es el
  <a href="https://es.wikipedia.org/wiki/Producto_escalar">producto escalar vectorial</a>.
  </li>

</ul>

<p>El artículo <a href="http://www.cs.cmu.edu/~baraff/papers/sig94.pdf">Fast contact
force computation for nonpenetrating rigid bodies.</a> por David Baraff entra de lleno en
detalles sobre cómo resolver la ecuación (1) sujeto a las restricciones (4). Voy a
dar una breve descripción aquí de cómo funciona el algoritmo descrito en ese documento.</p>


<p>El algoritmo comienza estableciendo todas las fuerzas de contacto en <span class="html-math inline-math">
<b>f</b>
</span> a cero. La idea básica es agregar una fuerza de contacto cada vez, agregando la fuerza suficiente para
mantener las restricciones y reajustar las otras fuerzas según sea necesario. Ignoramos los
puntos de contacto que aún no hemos considerado, aumentando gradualmente el conjunto de puntos de contacto
que obedecen las restricciones. Aquí hay un esquema muy simplificado de cómo funciona:</p>


<ul>
  <li>Comience considerando solo el contacto 1, ignorando todos los demás puntos de contacto (que están
    probablemente violando la restricción de <span class="html-math inline-math">
<i>a<sub>i</sub></i> >= 0
</span>). Calculamos la cantidad de
fuerza <span class="html-math inline-math">
<i>f<sub>1</sub></i>
</span> en el punto de contacto 1, que es suficiente para hacer
  <span class="html-math inline-math">
<i>a<sub>1</sub></i> = 0
</span>.</li>

  <li>A continuación, agregue el contacto 2. Resuelva para <span class="html-math inline-math">
<i>f<sub>2</sub></i>
</span>, ajustando <span class="html-math inline-math">
<i>f<sub>1</sub></i>
</span> según sea necesario,
para que las tres restricciones sean válidas para <span class="html-math inline-math">
<i>a<sub>1</sub></i>, <i>a<sub>2</sub></i>
</span> y <span class="html-math inline-math">
<i>f<sub>1</sub></i>, <i>f<sub>2</sub></i>
</span>.</li>

  <li>Continúe agregando contactos y fuerzas de contacto una a una cada vez, mientras ajusta
    fuerzas anteriores según sea necesario para mantener las tres restricciones de la
    ecuación&nbsp;(4).</li>
</ul>

<p>En cada punto estamos resolviendo un subconjunto de la ecuación matricial (1) que involucra solo
  los puntos de contacto que hemos considerado hasta ahora. En el paso final hemos añadido todos
  los puntos de contacto y, por lo tanto, se tiene una solución completa de la ecuación (1)
  que obedece a las restricciones de la ecuación&nbsp;(4).</p>

<p>Ahora que conocemos las fuerzas de contacto, el último paso es aplicarlas a los cuerpos,
  que da el conjunto final de aceleraciones de los cuerpos, y que el método <code>evaluate</code>
  luego lo devuelve al solucionador de ecuaciones diferenciales. La geometría de donde sea aplica cada fuerza a cada contacto
  del cuerpo entra en juego aquí para determinar cómo esa fuerza de contacto
  afecta la aceleración lineal y angular de un cuerpo dado. Este proceso es muy
  similar al descrito en <a href="../ImpulseApp/ImpulseApp-es.html">Colisiones de cuerpos rígidos</a>
  , la simulación para el tratamiento de fuerzas como la
<a href="../ImpulseApp/ImpulseApp-es.html#thrust_force">fuerza de empuje</a>.</p>

<p>El solucionador de ecuaciones diferenciales continúa evolucionando la simulación a lo largo del tiempo
  usando esas nuevas aceleraciones. Sin embargo, estas aceleraciones han sido precisamente
  calculadas para que los cuerpos que están en contacto de reposo permanezcan en contacto de reposo
  sin interpenetrarse.</p>


<h2 id="a_matrix">Calculando la Matriz <span class="html-math inline-math">
<b>A</b>
</span></h2>

<p>Nuestro objetivo aquí es calcular las entradas de la matriz <b>A</b> de la ecuación (1). Como
  descrito anteriormente, la <i>i</i>, <i>j</i>-ésima entrada en la matriz, <i>a<sub>i j</sub></i>, especificado cómo la <i>j</i>-ésima fuerza de contacto
, <i>f<sub>j</sub></i>, afecta la aceleración de la <i>i</i>-ésima distancia de contacto, <i>d<sub>i</sub>''</i>.</p>
<!-- <div class="centered_image"> -->
<img src="contact_5.png" width="301" height="298" alt=""><br>
2 cuerpos en contacto
<!-- </div> -->

<p>Para un punto de contacto particular <span class="html-math inline-math">
<i>i</i>
</span>, se numeran los cuerpos 1 y 2, con
el cuerpo 2 especificando el vector normal <span class="html-math inline-math">
<b><b>n</b></b><i><sub>i</sub></i>
</span> apuntando desde el cuerpo 2 hacia el cuerpo 1
(como en el diagrama de arriba). Sea <span class="html-math inline-math">
<b>p</b><sub>1</sub>
</span> el punto del cuerpo 1 que está en contacto
con el punto <span class="html-math inline-math">
<b>p</b><sub>2</sub>
</span> en el cuerpo 2. Sea <span class="html-math inline-math">
<i>d<sub>i</sub></i>
</span> la distancia entre <span class="html-math inline-math">
<b>p</b><sub>1</sub>
</span>
y <span class="html-math inline-math">
<b>p</b><sub>2</sub>
</span>. Si consideramos <span class="html-math inline-math">
<b>p</b><sub>1</sub>
</span> y <span class="html-math inline-math">
<b>p</b><sub>2</sub>
</span> como vectores desde el origen hasta
esos puntos en los cuerpos 1 y 2, entonces su diferencia <span class="html-math inline-math">
(<b>p</b><sub>1</sub> &minus; <b>p</b><sub>2</sub>)
</span> es también un
vector y podemos escribir</p>

<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
<i>d<sub>i</sub></i> = <b><b>n</b></b><i><sub>i</sub></i> &sdot; (<b>p</b><sub>1</sub> &minus; <b>p</b><sub>2</sub>)

</td><td class="equation-number">(5)</td></tr></table>

<p>porque el producto escalar con la normal nos da la componente del vector
<span class="html-math inline-math">
(<b>p</b><sub>1</sub> &minus; <b>p</b><sub>2</sub>)
</span> en la dirección de <span class="html-math inline-math">
<b>n</b>
</span>. Tenga en cuenta que <span class="html-math inline-math">
<i>d<sub>i</sub></i>
</span> es por lo tanto una cantidad escalar. Teniendo en cuenta que todas las variables de la ecuación (5)
son funciones del tiempo, podemos tomar la derivada dos veces de la siguiente manera:</p>


<p class="html-math display-equation">
<i>d<sub>i</sub></i>' = <b><b>n</b></b><i><sub>i</sub></i>' &sdot; (<b>p</b><sub>1</sub> &minus; <b>p</b><sub>2</sub>) + <b><b>n</b></b><i><sub>i</sub></i> &sdot; (<b>p</b><sub>1</sub>' &minus; <b>p</b><sub>2</sub>')<br>
<i>d<sub>i</sub></i>'' = <b><b>n</b></b><i><sub>i</sub></i>'' &sdot; (<b>p</b><sub>1</sub> &minus; <b>p</b><sub>2</sub>) + 2 <b><b>n</b></b><i><sub>i</sub></i>' &sdot; (<b>p</b><sub>1</sub>' &minus; <b>p</b><sub>2</sub>')
+ <b><b>n</b></b><i><sub>i</sub></i> &sdot; (<b>p</b><sub>1</sub>'' &minus; <b>p</b><sub>2</sub>'')
</p>

<p>Debido a que este es un punto de contacto, tenemos que <span class="html-math inline-math">
<b>p</b><sub>1</sub> &minus; <b>p</b><sub>2</sub> = 0
</span> por lo que lo
anterior se simplifica a</p>

<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
<i>d<sub>i</sub></i>'' = <b><b>n</b></b><i><sub>i</sub></i> &sdot; (<b>p</b><sub>1</sub>'' &minus; <b>p</b><sub>2</sub>'') + 2 <b><b>n</b></b><i><sub>i</sub></i>' &sdot; (<b>p</b><sub>1</sub>' &minus; <b>p</b><sub>2</sub>')

</td><td class="equation-number">(6)</td></tr></table>

<p>El segundo término,, <span class="html-math inline-math">
2 <b><b>n</b></b><i><sub>i</sub></i>' &sdot; (<b>p</b><sub>1</sub>' &minus; <b>p</b><sub>2</sub>')
</span>, depende de la velocidad (por lo que
puede ser calculado inmediatamente sin conocer las fuerzas involucradas), y por lo tanto es
parte de <span class="html-math inline-math">
<i>b<sub>i</sub></i>
</span>. Consulte <a href="#b_vector">Cálculo del vector<span class="html-math inline-math">
<b>b</b>
</span></a>
abajo. Así que <span class="html-math inline-math">
<i>f<sub>j</sub></i>
</span> la parte dependiente de la ecuación (6) es solo</p>

<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
  <b><b>n</b></b><i><sub>i</sub></i> &sdot; (<b>p</b><sub>1</sub>'' &minus; <b>p</b><sub>2</sub>'').

</td><td class="equation-number">(7)</td></tr></table>

<p>Una fuerza de contacto <span class="html-math inline-math">
<i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>j</sub></i>
</span> solo afecta a <span class="html-math inline-math">
<i>d<sub>i</sub></i>''
</span>  si esa fuerza de contacto
opera en el cuerpo 1 o el cuerpo 2. Si ese no es el caso, sabemos que <span class="html-math inline-math">
<i>a<sub>i j</sub></i> = 0
</span>.
Suponga ahora que <span class="html-math inline-math">
<i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>j</sub></i>
</span> afecta al cuerpo 1 o al cuerpo 2. Pero tenga en cuenta que
<span class="html-math inline-math">
<i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>j</sub></i>
</span> puede ser una fuerza de contacto que no está en <span class="html-math inline-math">
<i>i</i>
</span>-ésimo punto de contacto
(ver el diagrama anterior de 5 cuerpos en contacto por ejemplo). Podemos encontrar <span class="html-math inline-math">
<i>a<sub>i j</sub></i>
</span>
de la geometría de la situación de la siguiente manera.</p>

<p>Sea <span class="html-math inline-math">
<b><b>n</b></b><i><sub>j</sub></i>
</span> el vector normal en <span class="html-math inline-math">
<i>j</i>
</span>-ésimo punto de contacto. Asuma que
el <span class="html-math inline-math">
<i>j</i>
</span>-ésimo contacto involucra el cuerpo 1. Entonces la fuerza de contacto es <span class="html-math inline-math">
<i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>j</sub></i>
</span> si
el contacto involucra una esquina del cuerpo 1 o <span class="html-math inline-math">
&minus;<i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>j</sub></i>
</span> si el contacto implica
un borde del cuerpo 1. A partir de la geometría podemos calcular el efecto de la fuerza sobre el cuerpo
1, y por lo tanto en la aceleración de <span class="html-math inline-math">
<b>p</b><sub>1</sub>''
</span>. Si el contacto involucra el cuerpo 2,
entonces el efecto está en <span class="html-math inline-math">
<b>p</b><sub>2</sub>''
</span>. Entonces usando la ecuación (7) llegaremos a la
contribución de <span class="html-math inline-math">
<i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>j</sub></i>
</span> to <span class="html-math inline-math">
<i>a<sub>i j</sub></i>
</span>.</p>

<!-- <div class="centered_image"> -->
<img src="contact_4.png" width="429" height="307" alt=""><br>
3 cuerpos en contacto
<!-- </div> -->



<p>Defina las siguientes variables adicionales:</p>

<ul class="vars">

  <li><b>x</b><sub>1</sub> = centro de masa del cuerpo 1</li>

  <li><b>r</b><sub>1</sub> = vector desde el centro de masa del cuerpo 1 a <b>p</b><sub>1</sub> en el <i>i</i>-ésimo punto de contacto</li>

  <li><b>r</b><i><sub>j</sub></i> =  vector desde el centro de masa del cuerpo 1 hasta el <i>j</i>-ésimo punto de contacto</li>

  <li><i>&omega;</i><sub>1</sub> = magnitud de la velocidad angular del cuerpo 1</li>

  <li><b>&omega;</b><sub>1</sub> =  velocidad angular del cuerpo 1, un vector que es perpendicular al plano,
    entonces <b>&omega;</b><sub>1</sub> = {0, 0, <i>&omega;</i><sub>1</sub>}.</li>

  <li><b>v</b><sub>1</sub> = <b>x</b><sub>1</sub>' = vector de velocidad del centro de masa del cuerpo 1 </li>

  <li><i>m</i><sub>1</sub> = masa del cuerpo 1</li>

</ul>
<p>Entonces <span class="html-math inline-math">
<b>p</b><sub>1</sub> = <b>x</b><sub>1</sub> + <b>r</b><sub>1</sub>
</span>  y, reconociendo que todas estas variables son funciones
de tiempo, podemos tomar derivadas:</p>

<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
<b>p</b><sub>1</sub>' = <b>x</b><sub>1</sub>' + <b>r</b><sub>1</sub>' = <b>v</b><sub>1</sub> + <b>&omega;</b><sub>1</sub> &times; <b>r</b><sub>1</sub>

</td><td class="equation-number">(7a)</td></tr></table>

<p>Aquí usamos el conocimiento que <span class="html-math inline-math">
<b>r</b><sub>1</sub>
</span> solo cambia por rotación a una velocidad de
<span class="html-math inline-math">
<i>&omega;</i><sub>1</sub>
</span>. Un <a href="#rotating_vector">pedacito de cálculo elemental</a> da el
resultado que <span class="html-math inline-math">
<b>r</b><sub>1</sub>' = <b>&omega;</b><sub>1</sub> &times; <b>r</b><sub>1</sub>
</span> donde &times; indica
<a href="https://es.wikipedia.org/wiki/Producto_vectorial">producto vectorial cruzado</a>.
Tomando otra derivada:</p>

<p class="html-math display-equation">
<b>p</b><sub>1</sub>'' = <b>v</b><sub>1</sub>' + <b>&omega;</b><sub>1</sub>' &times; <b>r</b><sub>1</sub> + <b>&omega;</b><sub>1</sub> &times; <b>r</b><sub>1</sub>'
</p>

<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
<b>p</b><sub>1</sub>'' = <b>v</b><sub>1</sub>' + <b>&omega;</b><sub>1</sub>' &times; <b>r</b><sub>1</sub> + <b>&omega;</b><sub>1</sub> &times; (<b>&omega;</b><sub>1</sub> &times; <b>r</b><sub>1</sub>)

</td><td class="equation-number">(8)</td></tr></table>

<p>El término <span class="html-math inline-math">
<b>&omega;</b><sub>1</sub> &times; (<b>&omega;</b><sub>1</sub> &times; <b>r</b><sub>1</sub>)
</span> depende de la velocidad, por lo que entra en
el vector <a href="#b_vector"><span class="html-math inline-math">
<b>b</b>
</span></a>. El término <span class="html-math inline-math">
<i>f<sub>j</sub></i>
</span> que es parte dependiente de
<span class="html-math inline-math">
<b>p</b><sub>1</sub>''
</span> es por lo tanto</p>

<table class="html-math numbered-equation">
<tr><td class="equation-number">&nbsp;&nbsp;</td><td>
<b>v</b><sub>1</sub>' + <b>&omega;</b><sub>1</sub>' &times; <b>r</b><sub>1</sub>

</td><td class="equation-number">(8a)</td></tr></table>

<p>Nuestra tarea ahora es averiguar cuánto cambia una unidad en <span class="html-math inline-math">
<i>f<sub>j</sub></i>
</span> afectando a esto.</p>

<p>Debido a que <span class="html-math inline-math">
<b>v</b><sub>1</sub>'
</span> es la aceleración lineal del cuerpo 1, tenemos por la primera Ley de Newton</p>

<p class="html-math display-equation">
  <b>v</b><sub>1</sub>' = (fuerza total sobre el cuerpo 1) /<i>m</i><sub>1</sub>
</p>

<p>Por lo tanto <span class="html-math inline-math">
<i>f<sub>j</sub></i>
</span> la parte dependiente de <span class="html-math inline-math">
<b>v</b><sub>1</sub>'
</span> es</p>

<p class="html-math display-equation">
<i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>j</sub></i> /<i>m</i><sub>1</sub>
</p>

<p>Debido a que estamos trabajando en 2D, podemos escribir la aceleración angular como</p>

<p class="html-math display-equation">
<b>&omega;</b><sub>1</sub>' = <b>&tau;</b><sub>1</sub> / <i>I</i><sub>1</sub>
</p>

<p>donde <span class="html-math inline-math">
<b>&tau;</b><sub>1</sub> =
</span> es la torsión en el cuerpo 1 y <span class="html-math inline-math">
<i>I</i><sub>1</sub> =
</span> es la inercia rotacional del cuerpo 1
sobre el centro de masa. (Si está trabajando en 3D, la aceleración angular tiene otro
término; ver <a href="#calculate_contact_forces_detail">[Baraff-1]</a> para más
información). Suponga que <span class="html-math inline-math">
<i>j</i>
</span>-ésimo contacto ocurre en el punto <span class="html-math inline-math">
<b>p</b><i><sub>j</sub></i>
</span>,
y el vector <span class="html-math inline-math">
<b>r</b><i><sub>j</sub></i>
</span> va desde el centro de masa del objeto 1 a <span class="html-math inline-math">
<b>p</b><i><sub>j</sub></i>
</span>. Entonces la
fuerza <span class="html-math inline-math">
<i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>j</sub></i>
</span> contribuye con un par de <span class="html-math inline-math">
<b>r</b><i><sub>j</sub></i> &times; <i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>j</sub></i>
</span>. Así que <span class="html-math inline-math">
<i>f<sub>j</sub></i>
</span>
la parte dependiente de <span class="html-math inline-math">
<b>&omega;</b><sub>1</sub>'
</span> es</p>

<p class="html-math display-equation">
(<b>r</b><i><sub>j</sub></i> &times; <i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>j</sub></i>) / <i>I</i><sub>1</sub>
</p>

<p>y podemos escribir la ecuación (8a), la <span class="html-math inline-math">
<i>f<sub>j</sub></i>
</span> la parte dependiente de <span class="html-math inline-math">
<b>p</b><sub>1</sub>''
</span>, como</p>

<p class="html-math display-equation">
      <i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>j</sub></i> / <i>m</i><sub>1</sub> + (<b>r</b><i><sub>j</sub></i> &times; <i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>j</sub></i>) &times; <b>r</b><sub>1</sub> / <i>I</i><sub>1</sub><br>
       = <i>f<sub>j</sub></i> (<b><b>n</b></b><i><sub>j</sub></i> / <i>m</i><sub>1</sub> + (<b>r</b><i><sub>j</sub></i> &times; <b><b>n</b></b><i><sub>j</sub></i>) &times; <b>r</b><sub>1</sub> / <i>I</i><sub>1</sub>)
</p>

<p>y la parte fj dependiente de di'' en la ecuación (6) entonces es</p>

<p class="html-math display-equation">
  <i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>i</sub></i> &sdot; (<b><b>n</b></b><i><sub>j</sub></i> / <i>m</i><sub>1</sub> + (<b>r</b><i><sub>j</sub></i> &times; <b><b>n</b></b><i><sub>j</sub></i>) &times; <b>r</b><sub>1</sub> / <i>I</i><sub>1</sub>)
</p>

<p>Por lo tanto, mirando hacia atrás en la ecuación (2) para el contexto, tenemos la dependencia de
<span class="html-math inline-math">
<i>d<sub>i</sub></i>''
</span> en <span class="html-math inline-math">
<i>f<sub>j</sub></i>
</span> como</p>

<table class="html-math numbered-equation"><tr><td class="emphasized">
  <b><b>n</b></b><i><sub>i</sub></i> &sdot; (<b><b>n</b></b><i><sub>j</sub></i> / <i>m</i><sub>1</sub> + (<b>r</b><i><sub>j</sub></i> &times; <b><b>n</b></b><i><sub>j</sub></i>) &times; <b>r</b><sub>1</sub> / <i>I</i><sub>1</sub>)

</td><td class="equation-number">(9)</td></tr></table>

<p>que entra en <span class="html-math inline-math">
<i>a<sub>i j</sub></i>
</span>.</p>

<p>Recuerde que asumimos que <span class="html-math inline-math">
<i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>j</sub></i>
</span> afectó al cuerpo 1. Si en cambio es
<span class="html-math inline-math">
&minus;<i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>j</sub></i>
</span> está afectando al cuerpo 1, entonces cambia el signo de la expresión (9). Si
<span class="html-math inline-math">
<i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>j</sub></i>
</span> afecta al cuerpo 2 en lugar del cuerpo 1, entonces los efectos están en p2'' en la
ecuación (6), por lo que hay un cambio de signo y también usamos <span class="html-math inline-math">
<i>m</i><sub>2</sub>, <b>r</b><sub>2</sub>
</span>, y <span class="html-math inline-math">
<i>I</i><sub>2</sub>
</span>
en la expresión (9) y <span class="html-math inline-math">
<b>r</b><i><sub>j</sub></i>
</span> se calcula en relación con el cuerpo 2. Además, en el caso
donde <span class="html-math inline-math">
<i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>j</sub></i>
</span> está en un punto de contacto entre los cuerpos 1 y 2, entonces <span class="html-math inline-math">
<i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>j</sub></i>
</span>
afecta el cuerpo 1 y <span class="html-math inline-math">
&minus;<i>f<sub>j</sub></i> <b><b>n</b></b><i><sub>j</sub></i>
</span> afecta el cuerpo 2 y terminas usando expresión
(9) dos veces y poniendo la suma en <span class="html-math inline-math">
<i>a<sub>i j</sub></i>
</span>.</p>




<h2 id="b_vector">Calculando el vector <span class="html-math inline-math">
<b>b</b>
</span></h2>

<p>Aquí calculamos el vector <b>b</b> de la ecuación (1). El vector <b>b</b> especifica como sería
  la aceleración de la distancia de contacto <i>d<sub>i</sub></i>'' en ausencia de fuerzas de contacto. Eso
  depende de fuerzas sin contacto tales como gravedad, empuje, fuerza de resorte, amortiguamiento, etc., pero
  también tiene un componente dependiente de la velocidad.</p>

<p>Tenga en cuenta que son estas fuerzas las que hacen que existan las fuerzas de contacto; Las fuerzas de contacto se desarrollan en reacción a las otras fuerzas que están empujando los objetos juntos, por lo que las fuerzas de contacto también se conocen como "fuerzas de reacción".</p>

<p>En el contexto de resolver la ecuación (1), el vector <b>b</b> se considera una "constante"
  vector, porque en el momento en que estamos resolviendo la ecuación (1) para el contacto
  fuerzas, el vector <b>b</b> es una cantidad conocida.</p>

<!-- <div class="centered_image"> -->
<img src="contact_5.png" width="301" height="298" alt=""><br>
2 cuerpos en contacto
<!-- </div> -->

<p>Seguimos con el mismo escenario y variables definidas en el apartado anterior
<a href="#a_matrix">Cálculo de la Matriz <b>A</b></a>. Es decir, consideramos el <i>i</i>-ésimo
contacto, y numeramos los cuerpos como 1 y 2, donde el cuerpo 2 determina el vector normal
<b><b>n</b></b><i><sub>i</sub></i> del contacto. Estamos buscando una expresión para <i>b<sub>i</sub></i> en la ecuación (2). Empezamos desde
ecuación (6) que se derivó en la sección anterior:</p>
<p class="html-math display-equation">
<i>d<sub>i</sub></i>'' = <b><b>n</b></b><i><sub>i</sub></i> &sdot; (<b>p</b><sub>1</sub>'' &minus; <b>p</b><sub>2</sub>'') + 2 <b><b>n</b></b><i><sub>i</sub></i>' &sdot; (<b>p</b><sub>1</sub>' &minus; <b>p</b><sub>2</sub>')
</p>

<p>Primero consideramos el término 2  <b><b>n</b></b><i><sub>i</sub></i>'&sdot; (<b>p</b><sub>1</sub>' - <b>p</b><sub>2</sub>'). Depende solo de la corriente
  velocidad, no aceleración, por lo que es independiente de cualquier fuerza de contacto que se aplique,
  y por lo tanto pertenece al vector <b>b</b>. Recuerde que  <b><b>n</b></b><i><sub>i</sub></i> es la normal del cuerpo 2. Por lo tanto,
  si el cuerpo 2 está estacionario (una pared o un piso, por ejemplo), entonces su normalidad no cambia,
  entonces <b><b>n</b></b><i><sub>i</sub></i>' es el vector cero y este término es cero.</p>
<div style="margin-left: 3em; margin-right: 3em; max-width: 40em;">

<h3 id="rotating_vector">Derivación de <span class="html-math inline-math">
<b><b>n</b></b><i><sub>i</sub></i> '
</span></h3>
<p>Recuerde que <span class="html-math inline-math">
<b><b>n</b></b><i><sub>i</sub></i>
</span> es el vector normal al cuerpo 2 en el escenario de la
sección previa. Sabemos que el cuerpo 2 gira con velocidad angular <span class="html-math inline-math">
<i>&omega;</i><sub>2</sub>
</span>.
Por lo tanto, con un poco de cálculo elemental podemos escribir</p>

<p class="html-math display-equation">
<b><b>n</b></b><i><sub>i</sub></i>' = <b>&omega;</b><sub>2</sub> &times; <b><b>n</b></b><i><sub>i</sub></i>
</p>

<p>donde tratamos la velocidad angular como un vector <span class="html-math inline-math">
<b>&omega;</b><sub>2</sub>
</span> perpendicular al plano por lo que
que</p>

<p class="html-math display-equation">
<b>&omega;</b><sub>2</sub> = {0, 0, <i>&omega;</i><sub>2</sub>}
</p>

<p>Aquí está la derivación de ese resultado: Sea <span class="html-math inline-math">
<b><b>n</b></b><i><sub>i</sub></i>
</span> definido de la siguiente manera (debido a que
estamos en 2D la componente <i>z</i> es cero):</p>

<p class="html-math display-equation">
  <b><b>n</b></b><i><sub>i</sub></i> = {<i>n<sub>ix</sub></i>, <i>n<sub>iy</sub></i>, 0}
</p>

<p>Sabemos que el vector <span class="html-math inline-math">
<b><b>n</b></b><i><sub>i</sub></i>
</span> gira a una velocidad <span class="html-math inline-math">
<i>&omega;</i><sub>2</sub>
</span>. Ignorando cualquier
aceleración, podríamos escribir el vector <span class="html-math inline-math">
<b><b>n</b></b><i><sub>i</sub></i>
</span> como una función del tiempo como esta:</p>

<p class="html-math display-equation">
  <b><b>n</b></b><i><sub>i</sub></i> = |<b><b>n</b></b><i><sub>i</sub></i>| {cos(<i>&omega;</i><sub>2</sub> <i>t</i>), sin(<i>&omega;</i><sub>2</sub> <i>t</i>), 0}
</p>

<p>Donde <span class="html-math inline-math">
|<b><b>n</b></b><i><sub>i</sub></i>|
</span> es la magnitud del vector <span class="html-math inline-math">
<b><b>n</b></b><i><sub>i</sub></i>
</span>, y <span class="html-math inline-math">
<i>t</i>
</span> = tiempo.
La primera derivada entonces es</p>

<p class="html-math display-equation">
  <b><b>n</b></b><i><sub>i</sub></i>' = |<b><b>n</b></b><i><sub>i</sub></i>| {&minus;<i>&omega;</i><sub>2</sub> sin(<i>&omega;</i><sub>2</sub> <i>t</i>), <i>&omega;</i><sub>2</sub> cos(<i>&omega;</i><sub>2</sub> <i>t</i>), 0}
</p>

<p>que es equivalente a:</p>

<p class="html-math display-equation">
  <b><b>n</b></b><i><sub>i</sub></i>' = {&minus;<i>&omega;</i><sub>2</sub> <i>n<sub>iy</sub></i>, <i>&omega;</i><sub>2</sub> <i>n<sub>ix</sub></i>, 0}
</p>

<p>que también se puede expresar como
<a href="https://es.wikipedia.org/wiki/Producto_vectorial">producto cruzado</a> de los dos
vectores:</p>

<p class="html-math display-equation">
  <b><b>n</b></b><i><sub>i</sub></i>' = <b>&omega;</b><sub>2</sub> &times; <b><b>n</b></b><i><sub>i</sub></i>
</p>

</div>


<p>Ahora podemos usar esa expresión para <span class="html-math inline-math">
<b><b>n</b></b><i><sub>i</sub></i>'
</span> y la ecuación (7a) que da una
expresión para <span class="html-math inline-math">
<b>p</b><sub>1</sub>'
</span> (y de manera similar para <span class="html-math inline-math">
<b>p</b><sub>2</sub>'
</span> también) para escribir eso</p>

<table class="html-math numbered-equation"><tr><td class="emphasized">
2 <b><b>n</b></b><i><sub>i</sub></i>' &sdot; (<b>p</b><sub>1</sub>' &minus; <b>p</b><sub>2</sub>') = 2 (<b>&omega;</b><sub>2</sub> &times; <b><b>n</b></b><i><sub>i</sub></i>)
&sdot; (<b>v</b><sub>1</sub> + <b>&omega;</b><sub>1</sub> &times; <b>r</b><sub>1</sub> &minus; (<b>v</b><sub>2</sub> + <b>&omega;</b><sub>2</sub> &times; <b>r</b><sub>2</sub>))

</td><td class="equation-number">(10)</td></tr></table>

<p>La expresión anterior es parte de la ecuación (6) y se agrega a <span class="html-math inline-math">
<i>b<sub>i</sub></i>
</span>.  Pero
sólo en el caso de que el cuerpo 2 sea un objeto en movimiento; si el cuerpo 2 está estacionario (una pared o
piso por ejemplo), entonces <span class="html-math inline-math">
<b><b>n</b></b><i><sub>i</sub></i>'
</span> es cero.</p>

<p>A continuación, considere el término <span class="html-math inline-math">
<b><b>n</b></b><i><sub>i</sub></i> &sdot; (<b>p</b><sub>1</sub>'' &minus; <b>p</b><sub>2</sub>'')
</span> de la ecuación (6). Necesitamos incluirlo en <span class="html-math inline-math">
<i>b<sub>i</sub></i>
</span> el efecto de cualquier fuerza sin contacto en las aceleraciones
de los puntos de contacto <span class="html-math inline-math">
<b>p</b><sub>1</sub>
</span> y <span class="html-math inline-math">
<b>p</b><sub>2</sub>
</span>. Partiremos de la ecuación (8) que
se derivó en la sección anterior:</p>

<p class="html-math display-equation">
<b>p</b><sub>1</sub>'' = <b>v</b><sub>1</sub>' + <b>&omega;</b><sub>1</sub>' &times; <b>r</b><sub>1</sub> + <b>&omega;</b><sub>1</sub> &times; (<b>&omega;</b><sub>1</sub> &times; <b>r</b><sub>1</sub>)
</p>

<p>Resulta que las aceleraciones <span class="html-math inline-math">
<b>v</b><sub>1</sub>'
</span> y <span class="html-math inline-math">
<b>&omega;</b><sub>1</sub>'
</span> se deben a las fuerzas sin contacto que ya han sido calculadas para nosotros por los procesos anteriores (ver
método <code>evaluate</code> de la clase <code>ImpulseSim</code>). Esas aceleraciones son
pasadas a nuestro método <code>evaluate</code> y simplemente los conectamos a la ecuación
(8) para obtener <span class="html-math inline-math">
<b>p</b><sub>1</sub>''
</span> (y <span class="html-math inline-math">
<b>p</b><sub>2</sub>''
</span> que tiene una expresión similar). Entonces podemos escribir
esto fuera como</p>

<table class="html-math numbered-equation"><tr><td class="emphasized">
<b><b>n</b></b><i><sub>i</sub></i> &sdot; (<b>p</b><sub>1</sub>'' &minus; <b>p</b><sub>2</sub>'')
= <b><b>n</b></b><i><sub>i</sub></i> &sdot; (<b>v</b><sub>1</sub>' + <b>&omega;</b><sub>1</sub>' &times; <b>r</b><sub>1</sub> + <b>&omega;</b><sub>1</sub> &times; (<b>&omega;</b><sub>1</sub> &times; <b>r</b><sub>1</sub>)
&minus; (<b>v</b><sub>2</sub>' + <b>&omega;</b><sub>2</sub>' &times; <b>r</b><sub>2</sub> + <b>&omega;</b><sub>2</sub> &times; (<b>&omega;</b><sub>2</sub> &times; <b>r</b><sub>2</sub>)))

</td><td class="equation-number">(11)</td></tr></table>

<p>que es parte de la ecuación (6) que se agregará a <span class="html-math inline-math">
<i>b<sub>i</sub></i>
</span>. Tenga en cuenta que en la
ecuación anterior <span class="html-math inline-math">
<b>v</b><sub>1</sub>'
</span> y <span class="html-math inline-math">
<b>&omega;</b><sub>1</sub>'
</span> son las aceleraciones del cuerpo 1 debidas
<em>solo</em> a fuerzas sin contacto (y de manera similar para <span class="html-math inline-math">
<b>v</b><sub>2</sub>'
</span> y <span class="html-math inline-math">
<b>&omega;</b><sub>2</sub>'
</span>).</p>

<p>Ahora tenemos en las expresiones (10) y (11), las partes independientes de la fuerza de contacto de
  ecuación (6) que es lo que entra en <span class="html-math inline-math">
<i>b<sub>i</sub></i>
</span>.</p>

<p id="page_history">
  Esta página web se publicó por primera vez en enero de 2007.
</p>


<div id="footer2" >
  <div id="copyright">
    &copy; <a href="mailto:erikn@myPhysicsLab.com"
    title="send comments to Erik Neumann">
    Erik Neumann</a>,  2004-2016<br>
    <span id="revised_date">revisado Feb 6 2021</span>
  </div>
</div>

<!-- Call the app script after the body so that html entities are defined and
* the script can find them.-->
<script src="ContactApp-es.js"></script>

<script>
  (function build() {
    var elem_ids = {
      tab_list: 'header_bar',
      container: 'container',
      term_output: 'term_output',
      term_input: 'term_input',
      sim_applet: 'sim_applet',
      div_graph: 'div_graph',
      graph_controls: 'graph_controls',
      sim_controls: 'sim_controls',
      div_terminal: 'div_terminal',
      div_time_graph: 'div_time_graph',
      time_graph_controls: 'time_graph_controls',
      div_multi_graph: 'div_multi_graph',
      multi_graph_controls: 'multi_graph_controls',
      label_terminal: 'label_terminal',
      show_terminal: 'show_terminal',
      show_sim: 'show_sim',
      images_dir: '../common'
    };
    app = makeContactApp(elem_ids);
    app.defineNames('app');
    window.addEventListener('pageshow', function(event){
      // set language menu and compiled menus in case of back-button
      var menu = document.getElementById('language_menu');
      if (menu) { menu.selectedIndex = 2; }
      menu = document.getElementById('compiled_menu');
      if (menu) { menu.selectedIndex = 1; }
    }, /*capturing=*/false);
    window.addEventListener('blur', function(event){
      app.eval('FIRING=false;', /*output=*/false);
    }, /*capturing=*/false);
    window.addEventListener('focus', function(event){
      app.eval('FIRING=true;', /*output=*/false);
    }, /*capturing=*/false);
    app.eval('SIM_CANVAS.BACKGROUND="white"',/*output=*/false)
  }());
</script>

<script>
  document.getElementsByTagName("html")[0].style.visibility = "visible";
</script>

<script>var app; if (app) app.setup();</script>
<script>var app; if (app) app.start();</script>
<div id="footer2" >
  <div id="copyright">
    &copy; <a href="mailto:erikn@MyPhysicsLab.com"
    title="copyright 2020 Erik Neumann">
    Erik Neumann</a> 2020, available under
    <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2</a>
</div>
</body>
</html>
